<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Documentation for uDALES">
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>modmpi.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

         <script src="../js/jquery-2.1.3.min.js"></script>
         <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
                 data-toggle="dropdown" role="button"
                 aria-haspopup="true"
                 aria-expanded="false">
                 Contents <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                    <li><a href="../lists/files.html">Source Files</a></li>
                  <li><a href="../lists/modules.html">Modules</a></li>
                  <li><a href="../lists/procedures.html">Procedures</a></li>
                  <li><a href="../lists/types.html">Derived Types</a></li>
                  <li><a href="../program/dalesurban.html">Program</a></li>
              </ul>
            </li>
                <li class="visible-xs hidden-sm visible-lg">
                  <a href="../lists/files.html">Source Files</a>
                </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/modules.html">Modules</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/procedures.html">Procedures</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/types.html">Derived Types</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../program/dalesurban.html">Program</a>
              </li>
          </ul>
            <form action="../search.html" class="navbar-form navbar-right" role="search">
              <div class="form-group">
                <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
              </div>
              <!--
                  <button type="submit" class="btn btn-default">Submit</button>
                  -->
            </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>modmpi.f90
      <small>Source File</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 1.8% of total for source files.">253 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/modmpi.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
          <li class="active">modmpi.f90</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#mods-0">Modules</a>
        </h3>
      </div>
      <div id="mods-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../module/modmpi.html">modmpi</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/modmpi.f90.html#src">modmpi.f90</a>
      </div>
    </div>


  </div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: sourcefile~~modmpi.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemodmpif90AfferentGraph" width="641pt" height="696pt"
 viewBox="0.00 0.00 641.00 695.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modmpi.f90~~AfferentGraph" class="graph" transform="scale(0.54 0.54) rotate(0) translate(4 1286.85)">
<title>sourcefile~~modmpi.f90~~AfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1286.85 1185,-1286.85 1185,4 -4,4"/>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~modmpi.f90</title>
<polygon fill="none" stroke="black" points="77,-452.64 0,-452.64 0,-428.64 77,-428.64 77,-452.64"/>
<text text-anchor="middle" x="38.5" y="-438.24" font-family="Helvetica,sans-Serif" font-size="10.50">modmpi.f90</text>
</g>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~advec_2nd.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/advec_2nd.f90.html" xlink:title="advec_2nd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643,-1088.64 552,-1088.64 552,-1064.64 643,-1064.64 643,-1088.64"/>
<text text-anchor="middle" x="597.5" y="-1074.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">advec_2nd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M567.86,-1088.7C561.87,-1092.4 556.12,-1097.01 552,-1102.64 509.18,-1161.09 566.36,-1209.55 516,-1261.64 492.85,-1285.59 474.8,-1269.24 443.5,-1280.64"/>
</g>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~initfac.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/initfac.f90.html" xlink:title="initfac.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="319,-1087.64 253,-1087.64 253,-1063.64 319,-1063.64 319,-1087.64"/>
<text text-anchor="middle" x="286" y="-1073.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initfac.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M570.74,-1088.73C540.73,-1101.55 489.39,-1119.58 443.5,-1116.64"/>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M441.5,-1116.64C401.89,-1114.1 358.32,-1101.6 327.57,-1091.07"/>
<polygon fill="#255610" stroke="#255610" points="328.65,-1087.74 318.06,-1087.73 326.34,-1094.34 328.65,-1087.74"/>
</g>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~modglobal.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/modglobal.f90.html" xlink:title="modglobal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="203,-452.64 113,-452.64 113,-428.64 203,-428.64 203,-452.64"/>
<text text-anchor="middle" x="158" y="-438.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modglobal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M587.74,-1064.25C568.94,-1037.82 525.65,-977.77 516,-971.64 505.01,-964.66 296.9,-930.1 287,-921.64"/>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="481,-1046.64 404,-1046.64 404,-1022.64 481,-1022.64 481,-1046.64"/>
<text text-anchor="middle" x="442.5" y="-1032.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#025540" stroke-dasharray="5,2" d="M552.66,-1064.6C533.32,-1059.3 510.55,-1053.05 490.83,-1047.63"/>
<polygon fill="#025540" stroke="#025540" points="491.69,-1044.24 481.12,-1044.97 489.84,-1050.99 491.69,-1044.24"/>
</g>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node31" class="node">
<title>sourcefile~modfields.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node31"><a xlink:href=".././sourcefile/modfields.f90.html" xlink:title="modfields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328.5,-535.64 243.5,-535.64 243.5,-511.64 328.5,-511.64 328.5,-535.64"/>
<text text-anchor="middle" x="286" y="-521.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modfields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge98" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M592.2,-1064.56C581.28,-1034.46 550.85,-954.02 516,-891.64 460.26,-791.86 428.24,-778.38 369,-680.64 340.5,-633.62 311.81,-575.7 297.1,-545.04"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="300.13,-543.26 292.67,-535.74 293.81,-546.27 300.13,-543.26"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M252.92,-1085.5C225.23,-1091.91 185.61,-1095.76 159,-1075.64"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M273.47,-1063.51C262.68,-1051.38 247.04,-1031.71 239,-1011.64 158.43,-810.61 156.9,-541.53 158.36,-463.01"/>
<polygon fill="#202550" stroke="#202550" points="161.87,-462.92 158.59,-452.84 154.87,-462.76 161.87,-462.92"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="785,-590.64 679,-590.64 679,-566.64 785,-566.64 785,-590.64"/>
<text text-anchor="middle" x="732" y="-576.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M721.78,-566.51C694.47,-531.46 610.05,-429.31 516,-377.64 456.86,-345.15 432.73,-361.82 369,-339.64 320.8,-322.86 201.93,-219.03 159,-246.64"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="641,-708.64 554,-708.64 554,-684.64 641,-684.64 641,-708.64"/>
<text text-anchor="middle" x="597.5" y="-694.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M721.36,-590.7C706.08,-609.34 674.75,-645.58 643,-670.64 639.16,-673.67 634.94,-676.59 630.66,-679.31"/>
<polygon fill="transparent" stroke="transparent" points="628.68,-676.41 621.93,-684.58 632.3,-682.41 628.68,-676.41"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M717.95,-590.88C701.8,-605.16 672.75,-628.02 643,-637.64 558.59,-664.95 532.16,-648.07 443.5,-644.64"/>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="637.5,-750.64 557.5,-750.64 557.5,-726.64 637.5,-726.64 637.5,-750.64"/>
<text text-anchor="middle" x="597.5" y="-736.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#025510" stroke-dasharray="5,2" stroke-opacity="0.007843" d="M726.19,-590.65C715.14,-616.89 685.59,-680.01 643,-717.64 641.68,-718.81 640.28,-719.92 638.83,-720.99"/>
<polygon fill="#025510" fill-opacity="0.007843" stroke="#025510" stroke-opacity="0.007843" points="636.64,-718.23 630.06,-726.53 640.38,-724.15 636.64,-718.23"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge102" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M678.98,-579.78C654.51,-579.83 624.95,-579.17 598.5,-576.64"/>
</g>
<!-- sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~modchecksim.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/modchecksim.f90.html" xlink:title="modchecksim.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="496,-250.64 389,-250.64 389,-226.64 496,-226.64 496,-250.64"/>
<text text-anchor="middle" x="442.5" y="-236.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modchecksim.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M388.84,-245.34C358.92,-248.15 320.8,-250.06 287,-246.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M285,-246.64C229.28,-241 206.1,-216.35 159,-246.64"/>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M388.72,-250.24C350.66,-259.36 303.26,-272.5 287,-284.64"/>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge103" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M419.52,-250.66C402.93,-260.92 381.05,-277.24 369,-297.64 323.3,-375.04 384.45,-422.94 333,-496.64 330.68,-499.96 327.81,-502.94 324.65,-505.59"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="322.43,-502.86 316.32,-511.52 326.49,-508.57 322.43,-502.86"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M566.36,-708.85C561.36,-711.43 556.39,-714.38 552,-717.64 532.81,-731.91 532.86,-740.67 516,-757.64 453.69,-820.35 429.82,-827.48 369,-891.64 351.62,-909.98 350.94,-917.85 333,-935.64 324.19,-944.38 168.5,-1083.62 159,-1075.64"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M574.9,-684.62C559.03,-676.25 536.71,-665.41 516,-658.64 484.81,-648.44 476.29,-645.91 443.5,-644.64"/>
</g>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~modsave.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/modsave.f90.html" xlink:title="modsave.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="483.5,-924.64 401.5,-924.64 401.5,-900.64 483.5,-900.64 483.5,-924.64"/>
<text text-anchor="middle" x="442.5" y="-910.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modsave.f90</text>
</a>
</g>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#025522" stroke-dasharray="5,2" stroke-opacity="0.015686" d="M562.02,-708.76C558.23,-711.22 554.76,-714.16 552,-717.64 504.32,-777.84 566.53,-828.81 516,-886.64 509.86,-893.66 501.68,-898.79 493.04,-902.53"/>
<polygon fill="#025522" fill-opacity="0.015686" stroke="#025522" stroke-opacity="0.015686" points="491.69,-899.3 483.54,-906.07 494.13,-905.86 491.69,-899.3"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge105" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M587.09,-684.59C577.93,-672.77 563.73,-654.17 552,-637.64 535.31,-614.12 539.48,-600.39 516,-583.64 488.88,-564.3 476.72,-567.11 443.5,-564.64"/>
</g>
<!-- sourcefile~modeb.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~modeb.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/modeb.f90.html" xlink:title="modEB.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="478,-1088.64 407,-1088.64 407,-1064.64 478,-1064.64 478,-1088.64"/>
<text text-anchor="middle" x="442.5" y="-1074.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modEB.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M406.65,-1066.47C362.92,-1053.85 292.88,-1034.13 287,-1035.64"/>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M406.83,-1076.42C383.86,-1076.27 353.6,-1076.07 329.23,-1075.91"/>
<polygon fill="#255610" stroke="#255610" points="329.21,-1072.41 319.18,-1075.85 329.16,-1079.41 329.21,-1072.41"/>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M406.95,-1070.19C394.47,-1066.96 380.6,-1062.27 369,-1055.64 349.89,-1044.72 349.12,-1036.62 333,-1021.64 291.53,-983.09 265.9,-985.47 239,-935.64 193.68,-851.7 167.33,-548.7 160.68,-463.23"/>
<polygon fill="#202550" stroke="#202550" points="164.15,-462.77 159.9,-453.07 157.17,-463.31 164.15,-462.77"/>
</g>
<!-- sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~modstat_nc.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/modstat_nc.f90.html" xlink:title="modstat_nc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="333,-142.64 239,-142.64 239,-118.64 333,-118.64 333,-142.64"/>
<text text-anchor="middle" x="286" y="-128.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modstat_nc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#016325" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M406.71,-1075.07C392.8,-1072.55 377.98,-1067.08 369,-1055.64 309.89,-980.31 364.25,-285.15 333,-194.64 327.34,-178.25 316.01,-162.4 306.01,-150.57"/>
<polygon fill="#016325" fill-opacity="0.019608" stroke="#016325" stroke-opacity="0.019608" points="308.63,-148.25 299.38,-143.07 303.38,-152.88 308.63,-148.25"/>
</g>
<!-- sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~modfielddump.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/modfielddump.f90.html" xlink:title="modfielddump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="498,-128.64 387,-128.64 387,-104.64 498,-104.64 498,-128.64"/>
<text text-anchor="middle" x="442.5" y="-114.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modfielddump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M405.52,-104.58C363.22,-90.83 297.42,-70.93 287,-76.64"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M396.34,-128.73C387.22,-131.44 377.75,-134.47 369,-137.64 361.59,-140.33 244.29,-188.8 239,-194.64 208.26,-228.58 175.72,-364.58 163.76,-418.48"/>
<polygon fill="#202550" stroke="#202550" points="160.31,-417.87 161.59,-428.39 167.15,-419.37 160.31,-417.87"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#016325" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M386.59,-121.62C372.5,-122.89 357.31,-124.27 343.15,-125.55"/>
<polygon fill="#016325" fill-opacity="0.019608" stroke="#016325" stroke-opacity="0.019608" points="342.69,-122.08 333.05,-126.47 343.33,-129.05 342.69,-122.08"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge106" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M386.85,-124.58C380.03,-127.68 373.78,-131.9 369,-137.64 317.69,-199.25 376.27,-429.14 333,-496.64 330.93,-499.87 328.32,-502.76 325.41,-505.34"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="323.1,-502.7 317.14,-511.45 327.26,-508.33 323.1,-502.7"/>
</g>
<!-- sourcefile~modforces.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~modforces.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/modforces.f90.html" xlink:title="modforces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="487,-330.64 398,-330.64 398,-306.64 487,-306.64 487,-330.64"/>
<text text-anchor="middle" x="442.5" y="-316.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modforces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M425.01,-306.37C397.9,-287.3 341.47,-252.15 287,-246.64"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M397.83,-325.62C365.91,-331.86 322.23,-342.84 287,-360.64"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge107" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M420.49,-330.84C404.22,-341.31 382.29,-357.83 369,-377.64 338.22,-423.53 367.18,-453.22 333,-496.64 330.36,-500 327.17,-503.02 323.73,-505.72"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="321.64,-502.91 315.36,-511.45 325.59,-508.69 321.64,-502.91"/>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M112.91,-440.64C104.58,-440.64 95.83,-440.64 87.38,-440.64"/>
<polygon fill="#255000" stroke="#255000" points="87.29,-437.14 77.29,-440.64 87.29,-444.14 87.29,-437.14"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M403.7,-1029.85C372.01,-1027.02 325.85,-1025.69 287,-1035.64"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M403.71,-1044.67C381.14,-1050.66 352.43,-1058.28 329.13,-1064.46"/>
<polygon fill="#255610" stroke="#255610" points="327.95,-1061.15 319.18,-1067.1 329.75,-1067.92 327.95,-1061.15"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M403.67,-1027.95C391.96,-1024.78 379.42,-1020.21 369,-1013.64 322.66,-984.44 328.65,-957.22 287,-921.64"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge108" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M403.99,-1032.25C391.02,-1029.47 377.6,-1024.04 369,-1013.64 314.5,-947.78 354.14,-713.47 333,-630.64 325.06,-599.52 309.26,-565.82 298.42,-544.73"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="301.43,-542.94 293.69,-535.72 295.23,-546.2 301.43,-542.94"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M594.82,-750.8C584.04,-828.43 524.94,-1251.72 516,-1261.64 493.7,-1286.38 474.8,-1269.24 443.5,-1280.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M441.5,-1280.64C402.38,-1294.88 258.69,-1222.66 239,-1205.64 187.68,-1161.27 210.51,-1119.79 159,-1075.64"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M557.29,-734.02C495.4,-725.22 373.24,-701.56 287,-644.64"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#025522" stroke-dasharray="5,2" stroke-opacity="0.015686" d="M593.13,-750.9C584.81,-778.97 560.64,-848.39 516,-886.64 509.29,-892.39 501.2,-896.91 492.91,-900.44"/>
<polygon fill="#025522" fill-opacity="0.015686" stroke="#025522" stroke-opacity="0.015686" points="491.61,-897.19 483.51,-904.03 494.11,-903.73 491.61,-897.19"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge109" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M561.02,-726.58C513.78,-709.34 429.19,-674.29 369,-625.64 339.93,-602.15 314.36,-566.73 299.8,-544.41"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="302.58,-542.27 294.25,-535.72 296.68,-546.04 302.58,-542.27"/>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="909,-362.64 830,-362.64 830,-338.64 909,-338.64 909,-362.64"/>
<text text-anchor="middle" x="869.5" y="-348.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M841.43,-338.64C825.09,-331.39 803.85,-321.98 785,-313.64 681.46,-267.82 627.42,-295.09 552,-210.64 516.33,-170.69 557.81,-129.11 516,-95.64 436.27,-31.81 376.58,-27.59 287,-76.64"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M857.88,-362.66C847.4,-375.01 831.46,-395.13 821,-414.64 798.69,-456.27 808.22,-473.51 785,-514.64 775.96,-530.64 762.92,-546.69 752.15,-558.71"/>
<polygon fill="transparent" stroke="transparent" points="749.33,-556.61 745.14,-566.34 754.48,-561.35 749.33,-556.61"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M829.85,-342.04C777.67,-331.09 681.62,-313.27 598.5,-310.64"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge110" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M830.01,-362.85C826.88,-364.31 823.84,-365.9 821,-367.64 792.06,-385.34 632.26,-579.87 598.5,-576.64"/>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M596.5,-576.64C528.35,-573.75 511.52,-569.69 443.5,-564.64"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M426.61,-924.76C388.71,-955.57 291.28,-1034.54 287,-1035.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M285,-1035.64C270.77,-1039.28 170.72,-1084.5 159,-1075.64"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M422.18,-924.72C406.25,-935.46 383.93,-952.41 369,-971.64 345.59,-1001.8 358.87,-1021.56 333,-1049.64 330.13,-1052.75 326.81,-1055.59 323.28,-1058.14"/>
<polygon fill="#255610" stroke="#255610" points="321.31,-1055.24 314.8,-1063.6 325.1,-1061.13 321.31,-1055.24"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M413.57,-924.72C379.47,-937.36 322.04,-951.57 287,-921.64"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge111" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M421.45,-900.59C404.6,-889.34 381.36,-870.97 369,-848.64 321.44,-762.73 360.59,-724.88 333,-630.64 323.97,-599.82 308.44,-566.05 297.95,-544.86"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="301.01,-543.16 293.39,-535.8 294.76,-546.3 301.01,-543.16"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1057,-362.64 963,-362.64 963,-338.64 1057,-338.64 1057,-362.64"/>
<text text-anchor="middle" x="1010" y="-348.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M868.5,-696.64C704.13,-818.25 756.01,-927.24 643,-1097.64 592.05,-1174.47 592.91,-1210.8 516,-1261.64 488.21,-1280.01 474.8,-1269.24 443.5,-1280.64"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M868.5,-696.64C819.33,-734.05 765.13,-642.93 743.12,-599.78"/>
<polygon fill="transparent" stroke="transparent" points="746.17,-598.05 738.58,-590.65 739.9,-601.16 746.17,-598.05"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M731,-696.64C704.73,-696.74 675.54,-696.75 651.25,-696.73"/>
<polygon fill="transparent" stroke="transparent" points="651.17,-693.23 641.17,-696.72 651.16,-700.23 651.17,-693.23"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#812550" stroke-dasharray="5,2" d="M965.84,-362.71C950.82,-366.34 933.79,-369.84 918,-371.64 765.15,-389.05 584.53,-353.36 496.74,-332.41"/>
<polygon fill="#812550" stroke="#812550" points="497.55,-329.01 487.01,-330.06 495.91,-335.81 497.55,-329.01"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M731,-696.64C682.9,-696.82 684.42,-735.18 643,-759.64 626.57,-769.34 350.79,-900.73 333,-907.64 313.08,-915.38 303.21,-935.56 287,-921.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M285,-921.64C215.33,-857.21 172.39,-548.66 161.66,-462.84"/>
<polygon fill="#202550" stroke="#202550" points="165.13,-462.37 160.43,-452.87 158.18,-463.23 165.13,-462.37"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#025510" stroke-dasharray="5,2" stroke-opacity="0.007843" d="M731,-696.64C712.9,-696.71 670.53,-711.11 638.54,-723.03"/>
<polygon fill="#025510" fill-opacity="0.007843" stroke="#025510" stroke-opacity="0.007843" points="637.11,-719.83 628.98,-726.63 639.57,-726.38 637.11,-719.83"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#025516" stroke-dasharray="5,2" stroke-opacity="0.011765" d="M962.88,-350.64C948.82,-350.64 933.33,-350.64 919.11,-350.64"/>
<polygon fill="#025516" fill-opacity="0.011765" stroke="#025516" stroke-opacity="0.011765" points="919.03,-347.14 909.03,-350.64 919.03,-354.14 919.03,-347.14"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="918,-248.64 821,-248.64 821,-224.64 918,-224.64 918,-248.64"/>
<text text-anchor="middle" x="869.5" y="-234.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#200255" stroke-dasharray="5,2" d="M978.18,-338.52C969.98,-334.65 961.36,-329.97 954,-324.64 926.95,-305.06 901.38,-275.98 885.83,-256.68"/>
<polygon fill="#200255" stroke="#200255" points="888.56,-254.49 879.61,-248.81 883.07,-258.83 888.56,-254.49"/>
</g>
<!-- sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~modthermodynamics.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/modthermodynamics.f90.html" xlink:title="modthermodynamics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="516,-410.64 369,-410.64 369,-386.64 516,-386.64 516,-410.64"/>
<text text-anchor="middle" x="442.5" y="-396.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modthermodynamics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge95" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#810255" stroke-dasharray="5,2" d="M1008.37,-362.73C1005.02,-413.34 984.81,-609.66 870.5,-696.64"/>
<path fill="none" stroke="#810255" stroke-dasharray="5,2" d="M868.5,-696.64C811.15,-740.28 837.68,-606.82 785,-557.64 700,-478.29 655.2,-492.22 552,-438.64 535.94,-430.3 532.78,-426.41 516,-419.64 510.91,-417.59 505.55,-415.64 500.14,-413.83"/>
<polygon fill="#810255" stroke="#810255" points="500.98,-410.42 490.39,-410.7 498.84,-417.09 500.98,-410.42"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge112" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M868.5,-696.64C820.09,-732.46 793.22,-696.42 733,-696.64"/>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M731,-696.64C671.46,-696.86 691.15,-630.66 643,-595.64 625.61,-582.99 619.99,-577.55 598.5,-576.64"/>
</g>
<!-- sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M260.16,-142.72C253.02,-146.7 245.42,-151.45 239,-156.64 197.36,-190.26 204.01,-217.69 159,-246.64"/>
</g>
<!-- sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M255.62,-142.71C249.41,-146.4 243.42,-151.01 239,-156.64 222.4,-177.78 179.24,-355.18 164.23,-418.38"/>
<polygon fill="#202550" stroke="#202550" points="160.74,-417.94 161.85,-428.47 167.56,-419.55 160.74,-417.94"/>
</g>
<!-- sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~modstatistics.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/modstatistics.f90.html" xlink:title="modstatistics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="494,-170.64 391,-170.64 391,-146.64 494,-146.64 494,-170.64"/>
<text text-anchor="middle" x="442.5" y="-156.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modstatistics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M395.84,-170.73C357.22,-181.45 305.33,-197.13 287,-208.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M285,-208.64C235.46,-239.74 208.2,-215 159,-246.64"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M285,-208.64C207.75,-257.14 174.46,-370.42 163.47,-418.47"/>
<polygon fill="#202550" stroke="#202550" points="160,-417.93 161.3,-428.45 166.84,-419.42 160,-417.93"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#016325" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M390.91,-149.47C375.61,-146.7 358.71,-143.64 343.07,-140.8"/>
<polygon fill="#016325" fill-opacity="0.019608" stroke="#016325" stroke-opacity="0.019608" points="343.47,-137.32 333,-138.98 342.22,-144.2 343.47,-137.32"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge113" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M418.89,-170.7C402.19,-180.88 380.45,-197.08 369,-217.64 308.18,-326.88 401.95,-392.35 333,-496.64 330.88,-499.84 328.25,-502.71 325.31,-505.28"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="323,-502.63 317.01,-511.37 327.15,-508.28 323,-502.63"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1066,-248.64 954,-248.64 954,-224.64 1066,-224.64 1066,-248.64"/>
<text text-anchor="middle" x="1010" y="-234.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M990.92,-224.51C965.16,-207.68 915.97,-177.23 870.5,-158.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M868.5,-158.64C846.61,-149.69 841.75,-146 821,-134.64 781.15,-112.83 775.35,-99.09 733,-82.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M731,-82.64C655.81,-53.43 625.87,-85.06 552,-52.64 533.44,-44.49 533.88,-34.19 516,-24.64 486.06,-8.66 477.4,1.05 443.5,-0.64"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M596.5,-158.64C596.23,-158.62 443.76,-198.55 443.5,-198.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M441.5,-198.64C409.87,-209.07 397.13,-199.8 369,-217.64 347.95,-230.99 352.42,-245.02 333,-260.64 315.03,-275.09 305.48,-270.84 287,-284.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M285,-284.64C233.71,-322.94 191.11,-386.69 171.16,-419.58"/>
<polygon fill="#202550" stroke="#202550" points="168.04,-417.98 165.93,-428.36 174.06,-421.56 168.04,-417.98"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#016325" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M868.5,-158.64C812.76,-135.84 789.54,-137.9 733,-158.64"/>
<path fill="none" stroke="#016325" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M731,-158.64C675.71,-178.92 657.18,-163.65 598.5,-158.64"/>
<path fill="none" stroke="#016325" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M596.5,-158.64C541.02,-153.9 562.07,-93.91 516,-62.64 487.92,-43.58 477.33,-35.89 443.5,-38.64"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90</title>
<path fill="none" stroke="#010225" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M596.5,-158.64C566.21,-156.05 532.43,-155.78 504.32,-156.27"/>
<polygon fill="#010225" fill-opacity="0.019608" stroke="#010225" stroke-opacity="0.019608" points="504.17,-152.77 494.24,-156.48 504.32,-159.77 504.17,-152.77"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#200255" stroke-dasharray="5,2" d="M953.86,-236.64C945.5,-236.64 936.84,-236.64 928.42,-236.64"/>
<polygon fill="#200255" stroke="#200255" points="928.29,-233.14 918.29,-236.64 928.29,-240.14 928.29,-233.14"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge114" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M731,-158.64C707.1,-167.41 695.27,-163.06 679,-182.64 637.39,-232.72 672.73,-266.72 643,-324.64 614.34,-380.48 582.33,-377.69 552,-432.64 526.53,-478.79 554.23,-509.35 516,-545.64 491.84,-568.57 476.69,-567.47 443.5,-564.64"/>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M441.5,-564.64C402.31,-561.5 359.18,-549.28 328.47,-538.99"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="329.56,-535.66 318.96,-535.73 327.29,-542.29 329.56,-535.66"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M858.84,-224.42C830.82,-189.18 750.47,-89.43 733,-82.64"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M861.67,-248.73C851.93,-266.24 833.82,-299.83 821,-329.64 785.71,-411.75 753.14,-513.18 739.61,-556.91"/>
<polygon fill="transparent" stroke="transparent" points="736.25,-555.92 736.66,-566.5 742.94,-557.97 736.25,-555.92"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M842.33,-248.65C794.84,-269.33 690.84,-309.58 598.5,-310.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M596.5,-310.64C495.59,-302.03 464.89,-265.06 369,-297.64 325.48,-312.43 328.02,-339.91 287,-360.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M285,-360.64C264.23,-370.66 258.71,-372.67 239,-384.64 219.56,-396.45 198.53,-411.26 182.91,-422.68"/>
<polygon fill="#202550" stroke="#202550" points="180.8,-419.89 174.83,-428.64 184.95,-425.52 180.8,-419.89"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge115" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M854.71,-248.72C823.44,-276.09 744.78,-344.98 679,-402.64 606.53,-466.17 601.11,-500.44 516,-545.64 486.58,-561.26 476.72,-567.11 443.5,-564.64"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M368.96,-404.65C342.89,-405.24 313.4,-404.07 287,-398.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M285,-398.64C199.05,-380.96 232.8,-199.18 159,-246.64"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M285,-398.64C249.6,-391.36 210.31,-408.74 185.17,-423.31"/>
<polygon fill="#202550" stroke="#202550" points="183.33,-420.34 176.58,-428.5 186.95,-426.33 183.33,-420.34"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge116" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M382.62,-410.81C377.72,-413.23 373.08,-416.15 369,-419.64 340.29,-444.2 358.44,-468.71 333,-496.64 329.9,-500.04 326.27,-503.14 322.43,-505.93"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="320.3,-503.14 313.82,-511.52 324.11,-509.01 320.3,-503.14"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1181,-322.64 1102,-322.64 1102,-298.64 1181,-298.64 1181,-322.64"/>
<text text-anchor="middle" x="1141.5" y="-308.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M1133.45,-298.39C1121.64,-278.76 1096.17,-239.99 1066,-215.64 990.83,-154.97 965.92,-135.7 870.5,-120.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M868.5,-120.64C827.51,-105.43 825.94,-83.97 785,-68.64 706.38,-39.2 682.24,-44.69 598.5,-38.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M596.5,-38.64C527,-29.73 513.39,4.36 443.5,-0.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M441.5,-0.64C365.17,-6.11 353.85,-39.39 287,-76.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M285,-76.64C263.02,-88.89 255.94,-91.03 239,-109.64 191.53,-161.78 217.56,-207.37 159,-246.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M157,-246.64C93.82,-289 59.08,-377.9 45.84,-418.98"/>
<polygon fill="#255000" stroke="#255000" points="42.49,-417.97 42.87,-428.56 49.17,-420.05 42.49,-417.97"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M596.5,-1116.64C528.64,-1112.28 511.36,-1120.99 443.5,-1116.64"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M1009,-310.64C983.14,-310.09 975.38,-315.09 954,-329.64 933.67,-343.47 934.19,-353.14 918,-371.64 857.2,-441.1 783.83,-522.48 750.73,-559.08"/>
<polygon fill="transparent" stroke="transparent" points="748.05,-556.82 743.93,-566.59 753.24,-561.52 748.05,-556.82"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M596.5,-196.64C576.01,-198.09 527.45,-212.11 490.49,-223.56"/>
<polygon fill="transparent" stroke="transparent" points="489.39,-220.23 480.89,-226.56 491.47,-226.92 489.39,-220.23"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M731,-1116.64C672.61,-1108.96 657.27,-1120.42 598.5,-1116.64"/>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M596.5,-1116.64C557.85,-1114.16 515.34,-1102.27 484.96,-1092.09"/>
<polygon fill="transparent" stroke="transparent" points="485.74,-1088.66 475.15,-1088.72 483.47,-1095.28 485.74,-1088.66"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M868.5,-120.64C741.89,-102.82 591.97,-107.29 508.3,-112.04"/>
<polygon fill="transparent" stroke="transparent" points="507.96,-108.55 498.18,-112.63 508.37,-115.54 507.96,-108.55"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#812550" stroke-dasharray="5,2" d="M731,-196.64C629.12,-210.76 520.37,-270.94 470.87,-301.17"/>
<polygon fill="#812550" stroke="#812550" points="468.99,-298.21 462.33,-306.45 472.67,-304.16 468.99,-298.21"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M1101.96,-311.04C1076.21,-311.21 1041.57,-311.25 1011,-310.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M1009,-310.64C975.06,-309.96 977.29,-282.33 954,-257.64 937.13,-239.76 939.78,-227.04 918,-215.64 844.77,-177.31 815.42,-190.4 733,-196.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M731,-196.64C672.2,-199.81 657.24,-192.49 598.5,-196.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M596.5,-196.64C528.66,-201.43 508.08,-177.34 443.5,-198.64"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#025540" stroke-dasharray="5,2" d="M868.5,-1116.64C812.89,-1139.76 792.59,-1125.31 733,-1116.64"/>
<path fill="none" stroke="#025540" stroke-dasharray="5,2" d="M731,-1116.64C704.15,-1112.73 701.17,-1100.29 679,-1084.64 662.22,-1072.79 661.99,-1063.48 643,-1055.64 594.03,-1035.43 532.82,-1031.82 491.21,-1032.22"/>
<polygon fill="#025540" stroke="#025540" points="491,-1028.72 481.07,-1032.4 491.13,-1035.72 491,-1028.72"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#025516" stroke-dasharray="5,2" stroke-opacity="0.011765" d="M1009,-310.64C972.29,-309.86 932.17,-323.11 904.61,-334.56"/>
<polygon fill="#025516" fill-opacity="0.011765" stroke="#025516" stroke-opacity="0.011765" points="903.21,-331.35 895.41,-338.52 905.98,-337.79 903.21,-331.35"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#025522" stroke-dasharray="5,2" stroke-opacity="0.015686" d="M1139.2,-322.88C1127.88,-426.5 1042.34,-1151.95 870.5,-1116.64"/>
<path fill="none" stroke="#025522" stroke-dasharray="5,2" stroke-opacity="0.015686" d="M868.5,-1116.64C783.93,-1140.43 596.89,-971.93 516,-937.64 508.07,-934.28 499.52,-931.02 491.17,-928.03"/>
<polygon fill="#025522" fill-opacity="0.015686" stroke="#025522" stroke-opacity="0.015686" points="492.1,-924.64 481.5,-924.64 489.78,-931.25 492.1,-924.64"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#022425" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M1102,-322.53C1088.8,-326.61 1073.85,-331.23 1059.93,-335.53"/>
<polygon fill="#022425" fill-opacity="0.019608" stroke="#022425" stroke-opacity="0.019608" points="1058.55,-332.29 1050.03,-338.59 1060.61,-338.98 1058.55,-332.29"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#016325" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M596.5,-38.64C528.68,-33.74 511.28,-33.13 443.5,-38.64"/>
<path fill="none" stroke="#016325" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M441.5,-38.64C413.25,-40.94 347.32,-86.27 311.4,-112.43"/>
<polygon fill="#016325" fill-opacity="0.019608" stroke="#016325" stroke-opacity="0.019608" points="308.94,-109.89 302.95,-118.63 313.09,-115.53 308.94,-109.89"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#040255" stroke-dasharray="5,2" d="M1119.41,-298.59C1098.05,-286.38 1064.84,-267.41 1040.81,-253.67"/>
<polygon fill="#040255" stroke="#040255" points="1042.5,-250.61 1032.09,-248.69 1039.03,-256.69 1042.5,-250.61"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge94" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#200255" stroke-dasharray="5,2" d="M1009,-310.64C962.52,-309.65 916.5,-277.14 890.96,-255.54"/>
<polygon fill="#200255" stroke="#200255" points="893.25,-252.9 883.41,-248.97 888.65,-258.17 893.25,-252.9"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge96" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#810255" stroke-dasharray="5,2" d="M1009,-310.64C818.38,-306.03 595.76,-357.78 496.24,-383.99"/>
<polygon fill="#810255" stroke="#810255" points="495.2,-380.64 486.43,-386.59 496.99,-387.41 495.2,-380.64"/>
</g>
<!-- sourcefile~scalsource.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~scalsource.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node22"><a xlink:href=".././sourcefile/scalsource.f90.html" xlink:title="scalsource.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="487,-1004.64 398,-1004.64 398,-980.64 487,-980.64 487,-1004.64"/>
<text text-anchor="middle" x="442.5" y="-990.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scalsource.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M399.99,-1004.7C368.95,-1013.59 325.43,-1025.8 287,-1035.64"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M397.85,-1001.44C387.97,-1004.46 377.8,-1008.44 369,-1013.64 349.52,-1025.15 351.01,-1035.95 333,-1049.64 328.91,-1052.75 324.4,-1055.75 319.86,-1058.53"/>
<polygon fill="#255610" stroke="#255610" points="318.05,-1055.53 311.17,-1063.59 321.58,-1061.58 318.05,-1055.53"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M399.95,-980.54C366.67,-969.31 320.22,-950.02 287,-921.64"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge117" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M418.83,-980.61C402.1,-970.45 380.34,-954.26 369,-933.64 303.63,-814.82 368.14,-761.62 333,-630.64 324.68,-599.62 308.97,-565.9 298.25,-544.77"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="301.28,-543.02 293.58,-535.74 295.07,-546.23 301.28,-543.02"/>
</g>
<!-- sourcefile~tstep.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~tstep.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node23"><a xlink:href=".././sourcefile/tstep.f90.html" xlink:title="tstep.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="627,-628.64 568,-628.64 568,-604.64 627,-604.64 627,-628.64"/>
<text text-anchor="middle" x="597.5" y="-614.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tstep.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M580.43,-628.77C527.29,-669.39 354.07,-806.02 239,-945.64 195.85,-997.99 213.12,-1116.55 159,-1075.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M157,-1075.64C60.53,-994.54 42.88,-566.14 40.01,-462.99"/>
<polygon fill="#255000" stroke="#255000" points="43.51,-462.71 39.75,-452.8 36.51,-462.89 43.51,-462.71"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M567.73,-625.8C537.18,-634.6 487.35,-646.33 443.5,-644.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M441.5,-644.64C372.88,-641.99 344.31,-682.47 287,-644.64"/>
</g>
<!-- sourcefile~modchem.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~modchem.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node30"><a xlink:href=".././sourcefile/modchem.f90.html" xlink:title="modchem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="486,-616.64 399,-616.64 399,-592.64 486,-592.64 486,-616.64"/>
<text text-anchor="middle" x="442.5" y="-602.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modchem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge97" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90</title>
<path fill="none" stroke="#010225" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M567.72,-614.38C547.57,-612.8 520.07,-610.65 496.07,-608.76"/>
<polygon fill="#010225" fill-opacity="0.019608" stroke="#010225" stroke-opacity="0.019608" points="496.27,-605.27 486.03,-607.98 495.72,-612.25 496.27,-605.27"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge118" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M573.18,-604.55C543.84,-590.33 491.48,-568.2 443.5,-564.64"/>
</g>
<!-- sourcefile~wf_gr.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~wf_gr.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node24"><a xlink:href=".././sourcefile/wf_gr.f90.html" xlink:title="wf_gr.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="472.5,-1210.64 412.5,-1210.64 412.5,-1186.64 472.5,-1186.64 472.5,-1210.64"/>
<text text-anchor="middle" x="442.5" y="-1196.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wf_gr.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M412.37,-1191.39C381.03,-1183.31 329.91,-1169.29 287,-1153.64"/>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M412.35,-1195.85C397.93,-1193.17 381.07,-1187.92 369,-1177.64 340.54,-1153.41 358.46,-1129 333,-1101.64 330.12,-1098.54 326.78,-1095.72 323.25,-1093.17"/>
<polygon fill="#255610" stroke="#255610" points="325.07,-1090.18 314.76,-1087.71 321.28,-1096.06 325.07,-1090.18"/>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M412.17,-1193.85C398.36,-1190.69 382.09,-1185.62 369,-1177.64 349.13,-1165.54 351.57,-1153.66 333,-1139.64 314.6,-1125.75 301.69,-1133.42 287,-1115.64"/>
</g>
<!-- sourcefile~wf_uno.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~wf_uno.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node25"><a xlink:href=".././sourcefile/wf_uno.f90.html" xlink:title="wf_uno.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="477.5,-1168.64 407.5,-1168.64 407.5,-1144.64 477.5,-1144.64 477.5,-1168.64"/>
<text text-anchor="middle" x="442.5" y="-1154.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wf_uno.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M407.5,-1162.15C375.4,-1165.94 326.44,-1168.03 287,-1153.64"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M285,-1153.64C223.13,-1131.07 211.54,-1115.36 159,-1075.64"/>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M407.27,-1146.98C394.82,-1142.8 380.9,-1137.31 369,-1130.64 351.08,-1120.59 350,-1113.18 333,-1101.64 328.65,-1098.69 323.95,-1095.76 319.26,-1092.98"/>
<polygon fill="#255610" stroke="#255610" points="320.79,-1089.83 310.38,-1087.88 317.31,-1095.9 320.79,-1089.83"/>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M407.42,-1152.24C366.72,-1146.22 302.2,-1134.04 287,-1115.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M285,-1115.64C270.91,-1098.59 252.39,-1114.25 239,-1096.64 160.92,-993.98 158.28,-565.69 158.8,-462.89"/>
<polygon fill="#202550" stroke="#202550" points="162.3,-462.76 158.86,-452.74 155.3,-462.71 162.3,-462.76"/>
</g>
<!-- sourcefile~wfmneutral.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~wfmneutral.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node26"><a xlink:href=".././sourcefile/wfmneutral.f90.html" xlink:title="wfmneutral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="489.5,-1252.64 395.5,-1252.64 395.5,-1228.64 489.5,-1228.64 489.5,-1252.64"/>
<text text-anchor="middle" x="442.5" y="-1238.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wfmneutral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M285,-1191.64C268.83,-1175.2 257.1,-1181.92 239,-1167.64 196.46,-1134.08 202.22,-1108.32 159,-1075.64"/>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#255610" stroke-dasharray="5,2" d="M395.27,-1234.59C385.61,-1231.45 376.19,-1226.72 369,-1219.64 329.95,-1181.14 367.32,-1144.4 333,-1101.64 330.62,-1098.68 327.81,-1095.99 324.76,-1093.57"/>
<polygon fill="#255610" stroke="#255610" points="326.53,-1090.54 316.3,-1087.78 322.57,-1096.31 326.53,-1090.54"/>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M395.47,-1231.04C355.71,-1221.87 302.29,-1207.19 287,-1191.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M285,-1191.64C260.94,-1167.18 251.63,-1161.54 239,-1129.64 189.12,-1003.64 165.11,-566.65 160.04,-462.87"/>
<polygon fill="#202550" stroke="#202550" points="163.52,-462.46 159.55,-452.64 156.53,-462.8 163.52,-462.46"/>
</g>
<!-- sourcefile~advec_kappa.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~advec_kappa.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node27"><a xlink:href=".././sourcefile/advec_kappa.f90.html" xlink:title="advec_kappa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="494,-536.64 391,-536.64 391,-512.64 494,-512.64 494,-536.64"/>
<text text-anchor="middle" x="442.5" y="-522.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">advec_kappa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M399.19,-512.64C357.4,-500.87 298.15,-484.42 287,-482.64"/>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge99" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M390.91,-524.31C374.22,-524.2 355.64,-524.08 338.86,-523.98"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="338.7,-520.47 328.67,-523.91 338.65,-527.47 338.7,-520.47"/>
</g>
<!-- sourcefile~advec_upw.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~advec_upw.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node28"><a xlink:href=".././sourcefile/advec_upw.f90.html" xlink:title="advec_upw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="488,-494.64 397,-494.64 397,-470.64 488,-470.64 488,-494.64"/>
<text text-anchor="middle" x="442.5" y="-480.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">advec_upw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M396.92,-486.35C365.9,-488.02 323.68,-488.5 287,-482.64"/>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge100" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M396.81,-494.5C378.61,-499.33 357.45,-504.95 338.59,-509.95"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="337.44,-506.63 328.67,-512.58 339.24,-513.4 337.44,-506.63"/>
</g>
<!-- sourcefile~advection.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~advection.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node29"><a xlink:href=".././sourcefile/advection.f90.html" xlink:title="advection.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="485,-452.64 400,-452.64 400,-428.64 485,-428.64 485,-452.64"/>
<text text-anchor="middle" x="442.5" y="-438.24" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">advection.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M399.9,-452.39C355.13,-464.98 289.87,-483.1 287,-482.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M285,-482.64C254.04,-477.69 220.43,-466.15 195.71,-456.42"/>
<polygon fill="#202550" stroke="#202550" points="196.95,-453.15 186.37,-452.66 194.34,-459.64 196.95,-453.15"/>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge101" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M399.8,-448.96C389.33,-452.04 378.4,-456.17 369,-461.64 349.71,-472.86 350.75,-483.12 333,-496.64 328.58,-500.01 323.71,-503.28 318.83,-506.32"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="316.95,-503.36 310.16,-511.5 320.54,-509.37 316.95,-503.36"/>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M406.09,-616.73C363.66,-630.77 296.97,-651.22 287,-644.64"/>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M285,-644.64C217.42,-600.04 179.79,-505.44 165.62,-462.57"/>
<polygon fill="#202550" stroke="#202550" points="168.89,-461.31 162.52,-452.85 162.22,-463.44 168.89,-461.31"/>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge104" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#204025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M402.38,-592.6C391.35,-588.67 379.5,-583.94 369,-578.64 348.34,-568.21 326.67,-553.49 310.8,-541.9"/>
<polygon fill="#204025" fill-opacity="0.019608" stroke="#204025" stroke-opacity="0.019608" points="312.73,-538.98 302.62,-535.83 308.56,-544.6 312.73,-538.98"/>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#202550" stroke-dasharray="5,2" d="M263.72,-511.62C255.87,-507.07 246.95,-501.74 239,-496.64 220.1,-484.51 199.34,-469.94 183.7,-458.7"/>
<polygon fill="#202550" stroke="#202550" points="185.75,-455.86 175.59,-452.84 181.65,-461.53 185.75,-455.86"/>
</g>
</g>
</svg>
</div>                <script>
                  var pansourcefilemodmpif90AfferentGraph = svgPanZoom('#sourcefilemodmpif90AfferentGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>        <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
          <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                </div>
              <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 88.5,-24 88.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a file to a file which it depends on. A file
is dependent upon another if the latter must be compiled before the former
can be.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
<br>
    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#mods-1">Modules</a>
        </h3>
      </div>
      <div id="mods-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../module/modmpi.html">modmpi</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/modmpi.f90.html#src">modmpi.f90</a>
      </div>
    </div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="c">!&gt; \file modmpi.f90</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="c">!!  Layer to deal with the parallelization.</span>
<a id="ln-3" name="ln-3" href="#ln-3"></a>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="c">!&gt;</span>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="c">!!  Layer to deal with the parallelization.</span>
<a id="ln-6" name="ln-6" href="#ln-6"></a><span class="c">!&gt;</span>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="c">!!  \author Matthieu Pourquie, TU Delft</span>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="c">!!  \par Revision list</span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="c">!!  \todo Documentation</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a><span class="c">!!  \todo 2D/3D parallelization</span>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="c">!!  \todo Include interfaces for MPI_ALLREDUCE, MPI_ALLTOALL, MPI_BCAST,</span>
<a id="ln-12" name="ln-12" href="#ln-12"></a><span class="c">!! MPI_SENDRECV to get rid of pure mpi calls in the code</span>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="c">!  This file is part of DALES.</span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="c">!</span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="c">! DALES is free software; you can redistribute it and/or modify</span>
<a id="ln-16" name="ln-16" href="#ln-16"></a><span class="c">! it under the terms of the GNU General Public License as published by</span>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="c">! the Free Software Foundation; either version 3 of the License, or</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a><span class="c">! (at your option) any later version.</span>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="c">!</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a><span class="c">! DALES is distributed in the hope that it will be useful,</span>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="c">! but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="c">! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="c">! GNU General Public License for more details.</span>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="c">!</span>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="c">! You should have received a copy of the GNU General Public License</span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="c">! along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a id="ln-27" name="ln-27" href="#ln-27"></a><span class="c">!</span>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="c">!  Copyright 1993-2009 Delft University of Technology, Wageningen University, Utrecht University, KNMI</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="c">!</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a>
<a id="ln-31" name="ln-31" href="#ln-31"></a>
<a id="ln-32" name="ln-32" href="#ln-32"></a>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="k">module </span><span class="n">modmpi</span><span class="w"></span>
<a id="ln-34" name="ln-34" href="#ln-34"></a><span class="k">use </span><span class="n">mpi</span><span class="w"></span>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="k">implicit none</span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="k">save</span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="k">  </span><span class="kt">integer </span><span class="n">comm3d</span><span class="w"></span>
<a id="ln-38" name="ln-38" href="#ln-38"></a><span class="w">  </span><span class="kt">integer </span><span class="n">nbrtop</span><span class="w"></span>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="w">  </span><span class="kt">integer </span><span class="n">nbrbottom</span><span class="w"></span>
<a id="ln-40" name="ln-40" href="#ln-40"></a><span class="w">  </span><span class="kt">integer </span><span class="n">myid</span><span class="w"></span>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="w">  </span><span class="kt">integer </span><span class="n">nprocs</span><span class="w"></span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="w">  </span><span class="kt">integer </span><span class="n">mpierr</span><span class="w"></span>
<a id="ln-43" name="ln-43" href="#ln-43"></a><span class="w">  </span><span class="kt">integer </span><span class="n">my_real</span><span class="w"></span>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="w">  </span><span class="kt">real    </span><span class="n">CPU_program</span><span class="w">    </span><span class="c">!end time</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="w">  </span><span class="kt">real    </span><span class="n">CPU_program0</span><span class="w">   </span><span class="c">!start time</span>
<a id="ln-46" name="ln-46" href="#ln-46"></a>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cmyid</span><span class="w"></span>
<a id="ln-48" name="ln-48" href="#ln-48"></a>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="k">contains</span>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="k">  subroutine </span><span class="n">initmpi</span><span class="w"></span>
<a id="ln-51" name="ln-51" href="#ln-51"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="k">    </span><span class="kt">integer </span><span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="w">    </span><span class="kt">logical </span><span class="n">periods</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="w">    </span><span class="kt">integer </span><span class="n">periods2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-55" name="ln-55" href="#ln-55"></a>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_INIT</span><span class="p">(</span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-57" name="ln-57" href="#ln-57"></a><span class="w">    </span><span class="n">MY_REAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_DOUBLE_PRECISION</span><span class="w">  </span><span class="c">!MPI_REAL8 should be the same..</span>
<a id="ln-58" name="ln-58" href="#ln-58"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_COMM_RANK</span><span class="p">(</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="n">myid</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_COMM_SIZE</span><span class="p">(</span><span class="w"> </span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="n">nprocs</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-60" name="ln-60" href="#ln-60"></a><span class="c">! Specify the # procs in each direction.</span>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="c">! specifying a 0 means that MPI will try to find a useful # procs in</span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="c">! the corresponding  direction,</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a>
<a id="ln-64" name="ln-64" href="#ln-64"></a><span class="c">! specifying 1 means only 1 processor in this direction, meaning that</span>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="c">! we have in fact a grid of (at most) 2 dimensions left. This is used</span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="c">! when we want the array index range in 1 particular direction to be</span>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="c">! present on all processors in the grid</span>
<a id="ln-68" name="ln-68" href="#ln-68"></a>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="w">    </span><span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-70" name="ln-70" href="#ln-70"></a>
<a id="ln-71" name="ln-71" href="#ln-71"></a>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="c">! directions 1 and 2 are chosen periodic</span>
<a id="ln-73" name="ln-73" href="#ln-73"></a>
<a id="ln-74" name="ln-74" href="#ln-74"></a>
<a id="ln-75" name="ln-75" href="#ln-75"></a><span class="w">    </span><span class="n">periods</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<a id="ln-76" name="ln-76" href="#ln-76"></a><span class="c">! Soares 20080115</span>
<a id="ln-77" name="ln-77" href="#ln-77"></a><span class="w">    </span><span class="n">periods2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-78" name="ln-78" href="#ln-78"></a>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="c">! find suitable # procs in each direction</span>
<a id="ln-80" name="ln-80" href="#ln-80"></a>
<a id="ln-81" name="ln-81" href="#ln-81"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_DIMS_CREATE</span><span class="p">(</span><span class="w"> </span><span class="n">nprocs</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">dims</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-82" name="ln-82" href="#ln-82"></a>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="c">! create the Cartesian communicator, denoted by the integer comm3d</span>
<a id="ln-84" name="ln-84" href="#ln-84"></a>
<a id="ln-85" name="ln-85" href="#ln-85"></a><span class="w">    </span><span class="c">! BUG - Thijs, Harm</span>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="w">    </span><span class="c">!call MPI_CART_CREATE(MPI_COMM_WORLD, 1, dims, periods,.false., &amp;</span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">    </span><span class="c">!                    comm3d, ierr )</span>
<a id="ln-88" name="ln-88" href="#ln-88"></a>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_CART_CREATE</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">dims</span><span class="p">,</span><span class="w"> </span><span class="n">periods</span><span class="p">,.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="w">                        </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-91" name="ln-91" href="#ln-91"></a>
<a id="ln-92" name="ln-92" href="#ln-92"></a><span class="c">! Soares 20080115</span>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="c">!     call MPI_CART_CREATE(MPI_COMM_WORLD, 1, dims, periods2,1, &amp;</span>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="c">!                         comm3d, mpierr )</span>
<a id="ln-95" name="ln-95" href="#ln-95"></a>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="c">! Get my processor number in this communicator</span>
<a id="ln-97" name="ln-97" href="#ln-97"></a>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_COMM_RANK</span><span class="p">(</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">myid</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-99" name="ln-99" href="#ln-99"></a>
<a id="ln-100" name="ln-100" href="#ln-100"></a>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="c">! when applying boundary conditions, we need to know which processors</span>
<a id="ln-102" name="ln-102" href="#ln-102"></a><span class="c">! are neighbours in all 3 directions</span>
<a id="ln-103" name="ln-103" href="#ln-103"></a>
<a id="ln-104" name="ln-104" href="#ln-104"></a>
<a id="ln-105" name="ln-105" href="#ln-105"></a><span class="c">! these are determined with the aid of the MPI routine MPI_CART_SHIFT,</span>
<a id="ln-106" name="ln-106" href="#ln-106"></a>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_CART_SHIFT</span><span class="p">(</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nbrbottom</span><span class="p">,</span><span class="w"> </span><span class="n">nbrtop</span><span class="p">,</span><span class="w">   </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-108" name="ln-108" href="#ln-108"></a>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="c">! determine some useful MPI datatypes for sending/receiving data</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="w">     </span><span class="k">write</span><span class="p">(</span><span class="n">cmyid</span><span class="p">,</span><span class="s1">&#39;(i3.3)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">myid</span><span class="w"></span>
<a id="ln-112" name="ln-112" href="#ln-112"></a>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="k">      </span><span class="n">CPU_program0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_Wtime</span><span class="p">()</span><span class="w"></span>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="w">    </span><span class="k">end if</span>
<a id="ln-116" name="ln-116" href="#ln-116"></a>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;nprocs = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nprocs</span><span class="w"></span>
<a id="ln-118" name="ln-118" href="#ln-118"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">initmpi</span><span class="w"></span>
<a id="ln-119" name="ln-119" href="#ln-119"></a>
<a id="ln-120" name="ln-120" href="#ln-120"></a><span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a id="ln-121" name="ln-121" href="#ln-121"></a>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">exitmpi</span><span class="w"></span>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-124" name="ln-124" href="#ln-124"></a>
<a id="ln-125" name="ln-125" href="#ln-125"></a>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="k">    if</span><span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="k">      </span><span class="n">CPU_program</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPI_Wtime</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">CPU_program0</span><span class="w"></span>
<a id="ln-128" name="ln-128" href="#ln-128"></a><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;TOTAL CPU time = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">CPU_program</span><span class="w"></span>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="w">    </span><span class="k">end if</span>
<a id="ln-130" name="ln-130" href="#ln-130"></a>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="k">    call </span><span class="n">MPI_Comm_free</span><span class="p">(</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_FINALIZE</span><span class="p">(</span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-133" name="ln-133" href="#ln-133"></a><span class="w">  </span><span class="k">end subroutine </span><span class="n">exitmpi</span><span class="w"></span>
<a id="ln-134" name="ln-134" href="#ln-134"></a>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">barrou</span><span class="p">()</span><span class="w"></span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="k">    call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-138" name="ln-138" href="#ln-138"></a>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">  </span><span class="k">return</span>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="k">  end subroutine </span><span class="n">barrou</span><span class="w"></span>
<a id="ln-141" name="ln-141" href="#ln-141"></a>
<a id="ln-142" name="ln-142" href="#ln-142"></a>
<a id="ln-143" name="ln-143" href="#ln-143"></a>
<a id="ln-144" name="ln-144" href="#ln-144"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">excj</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">,</span><span class="w"> </span><span class="n">ey</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="p">)</span><span class="w"></span>
<a id="ln-145" name="ln-145" href="#ln-145"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-146" name="ln-146" href="#ln-146"></a>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="k">  </span><span class="kt">integer </span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">,</span><span class="w"> </span><span class="n">ey</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">,</span><span class="w"> </span><span class="n">ez</span><span class="w"></span>
<a id="ln-148" name="ln-148" href="#ln-148"></a><span class="w">  </span><span class="kt">real </span><span class="n">a</span><span class="p">(</span><span class="n">sx</span><span class="p">:</span><span class="n">ex</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">:</span><span class="n">ey</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">:</span><span class="n">ez</span><span class="p">)</span><span class="w"></span>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="w">  </span><span class="kt">integer </span><span class="n">iiget</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">)</span><span class="w"></span>
<a id="ln-150" name="ln-150" href="#ln-150"></a><span class="w">  </span><span class="kt">integer </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"></span>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">buffj1</span><span class="p">,</span><span class="n">buffj2</span><span class="p">,</span><span class="n">buffj3</span><span class="p">,</span><span class="n">buffj4</span><span class="w"></span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">  </span><span class="n">iiget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ez</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-153" name="ln-153" href="#ln-153"></a>
<a id="ln-154" name="ln-154" href="#ln-154"></a><span class="w">  </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">buffj1</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span><span class="w"></span>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">            </span><span class="n">buffj2</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span><span class="w"></span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">            </span><span class="n">buffj3</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span><span class="w"></span>
<a id="ln-157" name="ln-157" href="#ln-157"></a><span class="w">            </span><span class="n">buffj4</span><span class="p">(</span><span class="n">iiget</span><span class="p">))</span><span class="w"></span>
<a id="ln-158" name="ln-158" href="#ln-158"></a>
<a id="ln-159" name="ln-159" href="#ln-159"></a>
<a id="ln-160" name="ln-160" href="#ln-160"></a>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">nbrtop</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="k">    do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="w"></span>
<a id="ln-163" name="ln-163" href="#ln-163"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span><span class="n">ex</span><span class="w"></span>
<a id="ln-164" name="ln-164" href="#ln-164"></a><span class="w">      </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-165" name="ln-165" href="#ln-165"></a><span class="w">      </span><span class="n">buffj1</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ey</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="k">    enddo</span>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="k">  endif</span>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="k">  call </span><span class="n">MPI_SENDRECV</span><span class="p">(</span><span class="w">  </span><span class="n">buffj1</span><span class="p">,</span><span class="w">  </span><span class="n">ii</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="n">nbrtop</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-170" name="ln-170" href="#ln-170"></a><span class="w">                      </span><span class="n">buffj2</span><span class="p">,</span><span class="w">  </span><span class="n">iiget</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="n">nbrbottom</span><span class="p">,</span><span class="w">  </span><span class="mi">4</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">                      </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">nbrbottom</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a><span class="k">    do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="w"></span>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span><span class="n">ex</span><span class="w"></span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="w">      </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">      </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffj2</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"></span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="k">    enddo</span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="k">  endif</span><span class="w"></span>
<a id="ln-180" name="ln-180" href="#ln-180"></a>
<a id="ln-181" name="ln-181" href="#ln-181"></a><span class="c">!   call barrou()</span>
<a id="ln-182" name="ln-182" href="#ln-182"></a>
<a id="ln-183" name="ln-183" href="#ln-183"></a><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">nbrbottom</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a id="ln-184" name="ln-184" href="#ln-184"></a><span class="k">    do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="w"></span>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span><span class="n">ex</span><span class="w"></span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">      </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="w">      </span><span class="n">buffj3</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sy</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-188" name="ln-188" href="#ln-188"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="k">    enddo</span>
<a id="ln-190" name="ln-190" href="#ln-190"></a><span class="k">  endif</span>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="k">  call </span><span class="n">MPI_SENDRECV</span><span class="p">(</span><span class="w">  </span><span class="n">buffj3</span><span class="p">,</span><span class="w">  </span><span class="n">ii</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="n">nbrbottom</span><span class="p">,</span><span class="w">  </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">                          </span><span class="n">buffj4</span><span class="p">,</span><span class="w">  </span><span class="n">iiget</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="n">nbrtop</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="w">                          </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-194" name="ln-194" href="#ln-194"></a><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">nbrtop</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="k">    do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="w"></span>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span><span class="n">ex</span><span class="w"></span>
<a id="ln-197" name="ln-197" href="#ln-197"></a><span class="w">      </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">      </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ey</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffj4</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"></span>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="k">    enddo</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="k">  endif</span><span class="w"></span>
<a id="ln-202" name="ln-202" href="#ln-202"></a>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="c">!   call barrou()</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a><span class="w">  </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">buffj1</span><span class="p">,</span><span class="n">buffj2</span><span class="p">,</span><span class="n">buffj3</span><span class="p">,</span><span class="n">buffj4</span><span class="p">)</span><span class="w"></span>
<a id="ln-205" name="ln-205" href="#ln-205"></a>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">  </span><span class="k">return</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="k">  end subroutine </span><span class="n">excj</span><span class="w"></span>
<a id="ln-208" name="ln-208" href="#ln-208"></a>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="w">  </span><span class="c">! tg3315 - does some transfer of ghost cell information in the y-direction.</span>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="w">  </span><span class="c">! nbrbottom is cpu below and nbrtop is cpu above</span>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">  </span><span class="c">! MPI_PROC_NULL = -2???</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">excjs</span><span class="p">(</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">,</span><span class="w"> </span><span class="n">ey</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">)</span><span class="w"></span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-214" name="ln-214" href="#ln-214"></a><span class="k">  </span><span class="kt">integer </span><span class="n">sx</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="p">,</span><span class="w"> </span><span class="n">ey</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">,</span><span class="w"> </span><span class="n">ez</span><span class="p">,</span><span class="w"> </span><span class="n">ih</span><span class="p">,</span><span class="w"> </span><span class="n">jh</span><span class="w"></span>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">  </span><span class="kt">real </span><span class="n">a</span><span class="p">(</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="w"> </span><span class="n">sy</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">ey</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="w"> </span><span class="n">sz</span><span class="p">:</span><span class="n">ez</span><span class="p">)</span><span class="w"></span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">  </span><span class="kt">integer </span><span class="n">status</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">),</span><span class="w"> </span><span class="n">iiget</span><span class="w"></span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">  </span><span class="kt">integer </span><span class="n">ii</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"></span>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">buffj1</span><span class="p">,</span><span class="n">buffj2</span><span class="p">,</span><span class="n">buffj3</span><span class="p">,</span><span class="n">buffj4</span><span class="w"></span>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">  </span><span class="n">iiget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jh</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">ih</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ez</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">sz</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-220" name="ln-220" href="#ln-220"></a>
<a id="ln-221" name="ln-221" href="#ln-221"></a><span class="w">  </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">buffj1</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span><span class="w"></span>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="w">            </span><span class="n">buffj2</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span><span class="w"></span>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="w">            </span><span class="n">buffj3</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span><span class="w"></span>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="w">            </span><span class="n">buffj4</span><span class="p">(</span><span class="n">iiget</span><span class="p">))</span><span class="w"></span>
<a id="ln-225" name="ln-225" href="#ln-225"></a>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">nbrtop</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="k">    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">    </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jh</span><span class="w"></span>
<a id="ln-229" name="ln-229" href="#ln-229"></a><span class="w">    </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="w"></span>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span><span class="w"></span>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">      </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="w">      </span><span class="n">buffj1</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ey</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="c">! tg3315 buffj1 is je-jhc ghost cells on myid</span>
<a id="ln-233" name="ln-233" href="#ln-233"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="k">    enddo</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a><span class="k">    enddo</span>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="k">  endif</span>
<a id="ln-237" name="ln-237" href="#ln-237"></a>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="k">  call </span><span class="n">MPI_SENDRECV</span><span class="p">(</span><span class="w">  </span><span class="n">buffj1</span><span class="p">,</span><span class="w">  </span><span class="n">ii</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="n">nbrtop</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="w">                           </span><span class="n">buffj2</span><span class="p">,</span><span class="w">  </span><span class="n">iiget</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="n">nbrbottom</span><span class="p">,</span><span class="w">  </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-240" name="ln-240" href="#ln-240"></a><span class="w">                           </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-241" name="ln-241" href="#ln-241"></a>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="w">  </span><span class="c">! tg3315 sends this to nbrtop and pulls buffj2 from nbrbottom! send and receive process that is good for executing chain shifts.</span>
<a id="ln-243" name="ln-243" href="#ln-243"></a>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">nbrbottom</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="k">    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-246" name="ln-246" href="#ln-246"></a><span class="w">    </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jh</span><span class="w"></span>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="w">    </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="w"></span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span><span class="w"></span>
<a id="ln-249" name="ln-249" href="#ln-249"></a><span class="w">      </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-250" name="ln-250" href="#ln-250"></a><span class="w">      </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sy</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffj2</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="c">! set the previous ghost cells to buffj2 (last cells of nbrbottom I think)</span>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="k">    enddo</span>
<a id="ln-253" name="ln-253" href="#ln-253"></a><span class="k">    enddo</span>
<a id="ln-254" name="ln-254" href="#ln-254"></a><span class="k">  endif</span><span class="w"></span>
<a id="ln-255" name="ln-255" href="#ln-255"></a>
<a id="ln-256" name="ln-256" href="#ln-256"></a><span class="c">!   call barrou()</span>
<a id="ln-257" name="ln-257" href="#ln-257"></a>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="w">  </span><span class="c">! repeats this process for other way round</span>
<a id="ln-259" name="ln-259" href="#ln-259"></a>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">nbrbottom</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="k">    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="w">    </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jh</span><span class="w"></span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">    </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="w"></span>
<a id="ln-264" name="ln-264" href="#ln-264"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span><span class="w"></span>
<a id="ln-265" name="ln-265" href="#ln-265"></a><span class="w">      </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="w">      </span><span class="n">buffj3</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sy</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="k">    enddo</span>
<a id="ln-269" name="ln-269" href="#ln-269"></a><span class="k">    enddo</span>
<a id="ln-270" name="ln-270" href="#ln-270"></a><span class="k">  endif</span>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="k">  call </span><span class="n">MPI_SENDRECV</span><span class="p">(</span><span class="w">  </span><span class="n">buffj3</span><span class="p">,</span><span class="w">  </span><span class="n">ii</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="n">nbrbottom</span><span class="p">,</span><span class="w">  </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-272" name="ln-272" href="#ln-272"></a><span class="w">                          </span><span class="n">buffj4</span><span class="p">,</span><span class="w">  </span><span class="n">iiget</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="n">nbrtop</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="w">                          </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">nbrtop</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a><span class="k">    </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-276" name="ln-276" href="#ln-276"></a><span class="w">    </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jh</span><span class="w"></span>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">    </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="w"></span>
<a id="ln-278" name="ln-278" href="#ln-278"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span><span class="w"></span>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="w">      </span><span class="n">ii</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ii</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-280" name="ln-280" href="#ln-280"></a><span class="w">      </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ey</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">buffj4</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span><span class="w"></span>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="k">    enddo</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="k">    enddo</span>
<a id="ln-284" name="ln-284" href="#ln-284"></a><span class="k">  endif</span><span class="w"></span>
<a id="ln-285" name="ln-285" href="#ln-285"></a>
<a id="ln-286" name="ln-286" href="#ln-286"></a><span class="c">!   call barrou()</span>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="w">  </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">buffj1</span><span class="p">,</span><span class="n">buffj2</span><span class="p">,</span><span class="n">buffj3</span><span class="p">,</span><span class="n">buffj4</span><span class="p">)</span><span class="w"></span>
<a id="ln-288" name="ln-288" href="#ln-288"></a>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="w">  </span><span class="k">return</span>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="k">  end subroutine </span><span class="n">excjs</span><span class="w"></span>
<a id="ln-291" name="ln-291" href="#ln-291"></a>
<a id="ln-292" name="ln-292" href="#ln-292"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">slabsum</span><span class="p">(</span><span class="n">aver</span><span class="p">,</span><span class="n">ks</span><span class="p">,</span><span class="n">kf</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">,</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span><span class="p">)</span><span class="w"></span>
<a id="ln-293" name="ln-293" href="#ln-293"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-294" name="ln-294" href="#ln-294"></a>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="k">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ks</span><span class="p">,</span><span class="n">kf</span><span class="w"></span>
<a id="ln-296" name="ln-296" href="#ln-296"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">,</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span><span class="w"></span>
<a id="ln-297" name="ln-297" href="#ln-297"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">aver</span><span class="p">(</span><span class="n">ks</span><span class="p">:</span><span class="n">kf</span><span class="p">)</span><span class="w"></span>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-299" name="ln-299" href="#ln-299"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">averl</span><span class="p">(</span><span class="n">ks</span><span class="p">:</span><span class="n">kf</span><span class="p">)</span><span class="w"></span>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">avers</span><span class="p">(</span><span class="n">ks</span><span class="p">:</span><span class="n">kf</span><span class="p">)</span><span class="w"></span>
<a id="ln-301" name="ln-301" href="#ln-301"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w"></span>
<a id="ln-302" name="ln-302" href="#ln-302"></a>
<a id="ln-303" name="ln-303" href="#ln-303"></a><span class="w">    </span><span class="n">averl</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="w">    </span><span class="n">avers</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-305" name="ln-305" href="#ln-305"></a>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="w">    </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span><span class="w"></span>
<a id="ln-307" name="ln-307" href="#ln-307"></a><span class="w">      </span><span class="n">averl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ibs</span><span class="p">:</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">:</span><span class="n">jes</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="k">    call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">averl</span><span class="p">,</span><span class="w"> </span><span class="n">avers</span><span class="p">,</span><span class="w"> </span><span class="n">kf</span><span class="o">-</span><span class="n">ks</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-311" name="ln-311" href="#ln-311"></a><span class="w">                          </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-312" name="ln-312" href="#ln-312"></a>
<a id="ln-313" name="ln-313" href="#ln-313"></a><span class="w">    </span><span class="n">aver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aver</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">avers</span><span class="w"></span>
<a id="ln-314" name="ln-314" href="#ln-314"></a>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="w">    </span><span class="k">return</span>
<a id="ln-316" name="ln-316" href="#ln-316"></a><span class="k">  end subroutine </span><span class="n">slabsum</span><span class="w"></span>
<a id="ln-317" name="ln-317" href="#ln-317"></a>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">aver</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">II</span><span class="p">,</span><span class="n">IIs</span><span class="p">,</span><span class="n">lnan</span><span class="p">)</span><span class="w"></span>
<a id="ln-319" name="ln-319" href="#ln-319"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-320" name="ln-320" href="#ln-320"></a>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="k">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="w"></span>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">aver</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-324" name="ln-324" href="#ln-324"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">IIs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-326" name="ln-326" href="#ln-326"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">IId</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">averl</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-328" name="ln-328" href="#ln-328"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">avers</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">k</span><span class="w"></span>
<a id="ln-330" name="ln-330" href="#ln-330"></a><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lnan</span><span class="w"></span>
<a id="ln-331" name="ln-331" href="#ln-331"></a>
<a id="ln-332" name="ln-332" href="#ln-332"></a><span class="w">    </span><span class="n">averl</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="w">    </span><span class="n">avers</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-334" name="ln-334" href="#ln-334"></a>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="w">    </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="w"></span>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="w">      </span><span class="n">averl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<a id="ln-337" name="ln-337" href="#ln-337"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-338" name="ln-338" href="#ln-338"></a>
<a id="ln-339" name="ln-339" href="#ln-339"></a><span class="k">    </span><span class="n">IId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IIs</span><span class="w"></span>
<a id="ln-340" name="ln-340" href="#ln-340"></a>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="w">    </span><span class="c">! tg3315 22.03.19 - if not calculating stats and all blocks on lowest layer...</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="w">    </span><span class="c">! should not be necessary but value at kb is used in modthermo so reasonable value must</span>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="w">    </span><span class="c">! be assigned. Potentially should leave as before and only account for in modthermo...</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">lnan</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">IId</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="k">      </span><span class="n">averl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">))</span><span class="w"></span>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="w">      </span><span class="n">IId</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IId</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="w">    </span><span class="k">end if</span>
<a id="ln-348" name="ln-348" href="#ln-348"></a>
<a id="ln-349" name="ln-349" href="#ln-349"></a><span class="k">    call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">averl</span><span class="p">,</span><span class="w"> </span><span class="n">avers</span><span class="p">,</span><span class="w"> </span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="w">                          </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-351" name="ln-351" href="#ln-351"></a>
<a id="ln-352" name="ln-352" href="#ln-352"></a><span class="w">    </span><span class="k">where</span><span class="w"> </span><span class="p">(</span><span class="n">IId</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="w">      </span><span class="n">aver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">99</span><span class="mf">9.</span><span class="w"></span>
<a id="ln-354" name="ln-354" href="#ln-354"></a><span class="w">    </span><span class="n">elsewhere</span><span class="w"></span>
<a id="ln-355" name="ln-355" href="#ln-355"></a><span class="w">      </span><span class="n">aver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avers</span><span class="o">/</span><span class="n">IId</span><span class="w"></span>
<a id="ln-356" name="ln-356" href="#ln-356"></a><span class="w">    </span><span class="k">endwhere</span>
<a id="ln-357" name="ln-357" href="#ln-357"></a>
<a id="ln-358" name="ln-358" href="#ln-358"></a><span class="k">    return</span>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="k">  end subroutine </span><span class="n">avexy_ibm</span><span class="w"></span>
<a id="ln-360" name="ln-360" href="#ln-360"></a>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">slabsumi</span><span class="p">(</span><span class="n">aver</span><span class="p">,</span><span class="n">iis</span><span class="p">,</span><span class="n">iif</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">,</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span><span class="p">)</span><span class="w"></span>
<a id="ln-362" name="ln-362" href="#ln-362"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-363" name="ln-363" href="#ln-363"></a>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="k">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iis</span><span class="p">,</span><span class="n">iif</span><span class="w"></span>
<a id="ln-365" name="ln-365" href="#ln-365"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">,</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span><span class="w"></span>
<a id="ln-366" name="ln-366" href="#ln-366"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">aver</span><span class="p">(</span><span class="n">iis</span><span class="p">:</span><span class="n">iif</span><span class="p">)</span><span class="w"></span>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">averl</span><span class="p">(</span><span class="n">iis</span><span class="p">:</span><span class="n">iif</span><span class="p">)</span><span class="w"></span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">    </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">avers</span><span class="p">(</span><span class="n">iis</span><span class="p">:</span><span class="n">iif</span><span class="p">)</span><span class="w"></span>
<a id="ln-370" name="ln-370" href="#ln-370"></a><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<a id="ln-371" name="ln-371" href="#ln-371"></a>
<a id="ln-372" name="ln-372" href="#ln-372"></a><span class="w">    </span><span class="n">averl</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="w">    </span><span class="n">avers</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-374" name="ln-374" href="#ln-374"></a>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="w">    </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span><span class="w"></span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="w">      </span><span class="n">averl</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">jbs</span><span class="p">:</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">:</span><span class="n">kes</span><span class="p">))</span><span class="w"></span>
<a id="ln-377" name="ln-377" href="#ln-377"></a><span class="w">    </span><span class="k">enddo</span>
<a id="ln-378" name="ln-378" href="#ln-378"></a>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="k">    call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">averl</span><span class="p">,</span><span class="w"> </span><span class="n">avers</span><span class="p">,</span><span class="w"> </span><span class="n">iif</span><span class="o">-</span><span class="n">iis</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="w">                          </span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-381" name="ln-381" href="#ln-381"></a>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="w">    </span><span class="n">aver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aver</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">avers</span><span class="w"></span>
<a id="ln-383" name="ln-383" href="#ln-383"></a>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="w">    </span><span class="k">return</span>
<a id="ln-385" name="ln-385" href="#ln-385"></a><span class="k">  end subroutine </span><span class="n">slabsumi</span><span class="w"></span>
<a id="ln-386" name="ln-386" href="#ln-386"></a>
<a id="ln-387" name="ln-387" href="#ln-387"></a><span class="w">  </span><span class="c">!Could make this so it has cases like if the input is 1,2 or 3D...</span>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">avey_ibm</span><span class="p">(</span><span class="n">aver</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">II</span><span class="p">,</span><span class="n">IIt</span><span class="p">)</span><span class="w"></span>
<a id="ln-389" name="ln-389" href="#ln-389"></a><span class="w">  </span><span class="k">implicit none</span>
<a id="ln-390" name="ln-390" href="#ln-390"></a><span class="k">  </span><span class="kt">integer</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="w"></span>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="w">  </span><span class="kt">real</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">aver</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="w">  </span><span class="kt">real</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">avero</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-393" name="ln-393" href="#ln-393"></a><span class="w">  </span><span class="kt">real</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-394" name="ln-394" href="#ln-394"></a><span class="w">  </span><span class="kt">integer</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="w">  </span><span class="kt">integer</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">IIt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-396" name="ln-396" href="#ln-396"></a><span class="w">  </span><span class="kt">logical</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">lytdump</span><span class="p">,</span><span class="n">lnan</span><span class="w"></span>
<a id="ln-397" name="ln-397" href="#ln-397"></a>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="w">  </span><span class="n">avero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="w">  </span><span class="n">aver</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-400" name="ln-400" href="#ln-400"></a>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="w">  </span><span class="n">avero</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="o">*</span><span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="w"> </span><span class="nb">DIM</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-402" name="ln-402" href="#ln-402"></a>
<a id="ln-403" name="ln-403" href="#ln-403"></a><span class="w">  </span><span class="k">call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">avero</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="w"> </span><span class="n">aver</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">ke</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ie</span><span class="o">-</span><span class="n">ib</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-404" name="ln-404" href="#ln-404"></a>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="w">  </span><span class="k">where</span><span class="w"> </span><span class="p">(</span><span class="n">IIt</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<a id="ln-406" name="ln-406" href="#ln-406"></a><span class="w">    </span><span class="n">aver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">99</span><span class="mf">9.</span><span class="w"></span>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="w">  </span><span class="n">elsewhere</span><span class="w"></span>
<a id="ln-408" name="ln-408" href="#ln-408"></a><span class="w">    </span><span class="n">aver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aver</span><span class="o">/</span><span class="n">IIt</span><span class="w"></span>
<a id="ln-409" name="ln-409" href="#ln-409"></a><span class="w">  </span><span class="k">endwhere</span>
<a id="ln-410" name="ln-410" href="#ln-410"></a><span class="k"> </span>
<a id="ln-411" name="ln-411" href="#ln-411"></a><span class="k">  end subroutine </span><span class="n">avey_ibm</span><span class="w"></span>
<a id="ln-412" name="ln-412" href="#ln-412"></a>
<a id="ln-413" name="ln-413" href="#ln-413"></a><span class="w">  </span><span class="k">subroutine </span><span class="n">sumy_ibm</span><span class="p">(</span><span class="n">sumy</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">II</span><span class="p">)</span><span class="w"></span>
<a id="ln-414" name="ln-414" href="#ln-414"></a><span class="w">    </span><span class="c">! This routine sums up a variable over the y direction,</span>
<a id="ln-415" name="ln-415" href="#ln-415"></a><span class="w">    </span><span class="c">! only including the fluid cells.</span>
<a id="ln-416" name="ln-416" href="#ln-416"></a><span class="w">    </span><span class="k">implicit none</span>
<a id="ln-417" name="ln-417" href="#ln-417"></a><span class="k">    </span><span class="kt">integer</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="w"></span>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="w">    </span><span class="kt">real</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">sumy</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-419" name="ln-419" href="#ln-419"></a><span class="w">    </span><span class="kt">real</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">sumproc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-420" name="ln-420" href="#ln-420"></a><span class="w">    </span><span class="kt">real</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="w">    </span><span class="kt">integer</span><span class="w">                 </span><span class="kd">::</span><span class="w"> </span><span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-422" name="ln-422" href="#ln-422"></a>
<a id="ln-423" name="ln-423" href="#ln-423"></a><span class="w">    </span><span class="n">sumproc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="w">    </span><span class="n">sumy</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-425" name="ln-425" href="#ln-425"></a>
<a id="ln-426" name="ln-426" href="#ln-426"></a><span class="w">    </span><span class="n">sumproc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="o">*</span><span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="w"> </span><span class="nb">DIM</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<a id="ln-427" name="ln-427" href="#ln-427"></a>
<a id="ln-428" name="ln-428" href="#ln-428"></a><span class="w">    </span><span class="k">call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">sumproc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="w"> </span><span class="n">sumy</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="n">ke</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ie</span><span class="o">-</span><span class="n">ib</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="n">MPI_SUM</span><span class="p">,</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-429" name="ln-429" href="#ln-429"></a>
<a id="ln-430" name="ln-430" href="#ln-430"></a><span class="w">    </span><span class="k">end subroutine </span><span class="n">sumy_ibm</span><span class="w"></span>
<a id="ln-431" name="ln-431" href="#ln-431"></a>
<a id="ln-432" name="ln-432" href="#ln-432"></a><span class="k">end module</span><span class="w"></span>
</pre></div>

    </section>
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-xs-6 col-md-6"><p>uDALES was developed by The uDALES Team<br>&copy; 2023 
</p>
          </div>
          <div class="col-xs-6 col-md-6">
            <p class="text-right">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2023-05-30 17:12              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
         ================================================== -->
         <!-- Placed at the end of the document so the pages load faster -->
    <!--
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        -->
        <script src="../js/bootstrap.min.js"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="../js/ie10-viewport-bug-workaround.js"></script>

        <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>