<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Documentation for uDALES">
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>modglobal.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
      <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

         <script src="../js/jquery-2.1.3.min.js"></script>
         <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
                 data-toggle="dropdown" role="button"
                 aria-haspopup="true"
                 aria-expanded="false">
                 Contents <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                    <li><a href="../lists/files.html">Source Files</a></li>
                  <li><a href="../lists/modules.html">Modules</a></li>
                  <li><a href="../lists/procedures.html">Procedures</a></li>
                  <li><a href="../lists/types.html">Derived Types</a></li>
                  <li><a href="../program/dalesurban.html">Program</a></li>
              </ul>
            </li>
                <li class="visible-xs hidden-sm visible-lg">
                  <a href="../lists/files.html">Source Files</a>
                </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/modules.html">Modules</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/procedures.html">Procedures</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/types.html">Derived Types</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../program/dalesurban.html">Program</a>
              </li>
          </ul>
            <form action="../search.html" class="navbar-form navbar-right" role="search">
              <div class="form-group">
                <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
              </div>
              <!--
                  <button type="submit" class="btn btn-default">Submit</button>
                  -->
            </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>modglobal.f90
      <small>Source File</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 3.3% of total for source files.">472 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/modglobal.f90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
          <li class="active">modglobal.f90</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#mods-0">Modules</a>
        </h3>
      </div>
      <div id="mods-0" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../module/modglobal.html">modglobal</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/modglobal.f90.html#src">modglobal.f90</a>
      </div>
    </div>


  </div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: sourcefile~~modglobal.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemodglobalf90EfferentGraph" width="211pt" height="32pt"
 viewBox="0.00 0.00 211.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modglobal.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~modglobal.f90~~EfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 207,-28 207,4 -4,4"/>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~modglobal.f90</title>
<polygon fill="none" stroke="black" points="203,-24 113,-24 113,0 203,0 203,-24"/>
<text text-anchor="middle" x="158" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">modglobal.f90</text>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~modglobal.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~modglobal.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="77,-24 0,-24 0,0 77,0 77,-24"/>
<text text-anchor="middle" x="38.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modglobal.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M112.91,-12C104.58,-12 95.83,-12 87.38,-12"/>
<polygon fill="#255000" stroke="#255000" points="87.29,-8.5 77.29,-12 87.29,-15.5 87.29,-8.5"/>
</g>
</g>
</svg>
</div>        <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
          <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                </div>
              <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 88.5,-24 88.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a file to a file which it depends on. A file
is dependent upon another if the latter must be compiled before the former
can be.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: sourcefile~~modglobal.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemodglobalf90AfferentGraph" width="641pt" height="657pt"
 viewBox="0.00 0.00 641.00 657.09" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modglobal.f90~~AfferentGraph" class="graph" transform="scale(0.59 0.59) rotate(0) translate(4 1104.14)">
<title>sourcefile~~modglobal.f90~~AfferentGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1104.14 1077,-1104.14 1077,4 -4,4"/>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~modglobal.f90</title>
<polygon fill="none" stroke="black" points="90,-567.43 0,-567.43 0,-543.43 90,-543.43 90,-567.43"/>
<text text-anchor="middle" x="45" y="-553.03" font-family="Helvetica,sans-Serif" font-size="10.50">modglobal.f90</text>
</g>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~advec_2nd.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/advec_2nd.f90.html" xlink:title="advec_2nd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="494,-897.43 403,-897.43 403,-873.43 494,-873.43 494,-897.43"/>
<text text-anchor="middle" x="448.5" y="-883.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">advec_2nd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M418.86,-897.5C412.87,-901.19 407.12,-905.8 403,-911.43 360.18,-969.88 423.61,-1025.21 367,-1070.43 299.59,-1124.29 246.1,-1096.83 174,-1049.43"/>
</g>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~initfac.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/initfac.f90.html" xlink:title="initfac.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-897.43 140,-897.43 140,-873.43 206,-873.43 206,-897.43"/>
<text text-anchor="middle" x="173" y="-883.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initfac.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M424.66,-897.58C398.27,-910.34 353.23,-928.21 312.5,-925.43"/>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M310.5,-925.43C275.94,-923.07 238.27,-911.29 211.28,-901.12"/>
<polygon fill="transparent" stroke="transparent" points="212.43,-897.81 201.84,-897.46 209.9,-904.34 212.43,-897.81"/>
</g>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~modfields.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/modfields.f90.html" xlink:title="modfields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="215.5,-567.43 130.5,-567.43 130.5,-543.43 215.5,-543.43 215.5,-567.43"/>
<text text-anchor="middle" x="173" y="-553.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modfields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M445.03,-873.14C433.92,-818.28 388.16,-597.4 367,-574.43 349.62,-555.56 337.34,-561.85 312.5,-555.43"/>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="350,-813.43 273,-813.43 273,-789.43 350,-789.43 350,-813.43"/>
<text text-anchor="middle" x="311.5" y="-799.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#025517" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M424.09,-873.34C417.05,-869.29 409.48,-864.5 403,-859.43 384.93,-845.29 386.15,-835.07 367,-822.43 364.58,-820.83 362.02,-819.33 359.38,-817.92"/>
<polygon fill="#025517" fill-opacity="0.019608" stroke="#025517" stroke-opacity="0.019608" points="360.73,-814.69 350.21,-813.49 357.69,-820.99 360.73,-814.69"/>
</g>
<!-- sourcefile~advec_kappa.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~advec_kappa.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/advec_kappa.f90.html" xlink:title="advec_kappa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-691.43 260,-691.43 260,-667.43 363,-667.43 363,-691.43"/>
<text text-anchor="middle" x="311.5" y="-677.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">advec_kappa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M274.97,-691.51C268.52,-694.15 261.95,-697.15 256,-700.43 216.22,-722.35 215.23,-780.49 174,-761.43"/>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M271.63,-667.42C266.13,-664.89 260.74,-661.91 256,-658.43 225.39,-635.97 199.98,-599.29 185.91,-576.3"/>
<polygon fill="#025570" stroke="#025570" points="188.88,-574.45 180.75,-567.65 182.87,-578.03 188.88,-574.45"/>
</g>
<!-- sourcefile~advec_upw.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~advec_upw.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/advec_upw.f90.html" xlink:title="advec_upw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="357,-649.43 266,-649.43 266,-625.43 357,-625.43 357,-649.43"/>
<text text-anchor="middle" x="311.5" y="-635.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">advec_upw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M271.63,-649.44C266.13,-651.97 260.74,-654.95 256,-658.43 208.83,-693.05 227.11,-785.99 174,-761.43"/>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M274.97,-625.35C268.52,-622.71 261.95,-619.71 256,-616.43 234.03,-604.32 211.32,-586.99 195.39,-573.89"/>
<polygon fill="#025570" stroke="#025570" points="197.63,-571.2 187.71,-567.48 193.14,-576.57 197.63,-571.2"/>
</g>
<!-- sourcefile~advection.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~advection.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/advection.f90.html" xlink:title="advection.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="354,-607.43 269,-607.43 269,-583.43 354,-583.43 354,-607.43"/>
<text text-anchor="middle" x="311.5" y="-593.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">advection.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M269.72,-607.48C264.79,-609.96 260.07,-612.92 256,-616.43 199.95,-664.8 241.2,-792.5 174,-761.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M172,-761.43C96.79,-726.66 62.6,-622.78 50.93,-577.24"/>
<polygon fill="#255000" stroke="#255000" points="54.32,-576.36 48.55,-567.47 47.52,-578.02 54.32,-576.36"/>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M269.55,-583.43C255.64,-579.35 239.92,-574.75 225.3,-570.46"/>
<polygon fill="#025570" stroke="#025570" points="225.98,-567.02 215.4,-567.56 224.01,-573.73 225.98,-567.02"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M166.71,-873.3C157.94,-853.11 140.01,-811.29 126,-775.43 97.9,-703.5 67.44,-617.14 53.6,-577.4"/>
<polygon fill="#255000" stroke="#255000" points="56.89,-576.21 50.31,-567.91 50.28,-578.51 56.89,-576.21"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="656.5,-592.43 550.5,-592.43 550.5,-568.43 656.5,-568.43 656.5,-592.43"/>
<text text-anchor="middle" x="603.5" y="-578.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M597.96,-592.61C583.37,-629.47 533.7,-738.65 449.5,-761.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M447.5,-761.43C389.58,-777.1 370.81,-747.31 312.5,-761.43"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="492,-552.43 405,-552.43 405,-528.43 492,-528.43 492,-552.43"/>
<text text-anchor="middle" x="448.5" y="-538.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#872550" stroke-dasharray="5,2" d="M556.59,-568.43C539.52,-563.97 520.02,-558.87 502.38,-554.25"/>
<polygon fill="#872550" stroke="#872550" points="502.79,-550.75 492.23,-551.6 501.02,-557.52 502.79,-550.75"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M550.29,-581.11C491.54,-580.69 393.72,-576.41 312.5,-555.43"/>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="488.5,-632.43 408.5,-632.43 408.5,-608.43 488.5,-608.43 488.5,-632.43"/>
<text text-anchor="middle" x="448.5" y="-618.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#025522" stroke-dasharray="5,2" stroke-opacity="0.031373" d="M556.59,-592.43C538.24,-597.23 517.07,-602.76 498.43,-607.64"/>
<polygon fill="#025522" fill-opacity="0.031373" stroke="#025522" stroke-opacity="0.031373" points="497.44,-604.28 488.65,-610.2 499.21,-611.05 497.44,-604.28"/>
</g>
<!-- sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~modchecksim.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/modchecksim.f90.html" xlink:title="modchecksim.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="365,-295.43 258,-295.43 258,-271.43 365,-271.43 365,-295.43"/>
<text text-anchor="middle" x="311.5" y="-281.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modchecksim.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M277.49,-295.49C249.18,-306.39 207.76,-323.73 174,-343.43"/>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M296.37,-295.82C284.31,-307.01 267.2,-324.43 256,-342.43 216.11,-406.53 190.18,-493.2 179.52,-533.34"/>
<polygon fill="#025570" stroke="#025570" points="176.1,-532.6 176.97,-543.15 182.87,-534.35 176.1,-532.6"/>
</g>
<!-- sourcefile~modchem.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~modchem.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/modchem.f90.html" xlink:title="modchem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="355,-375.43 268,-375.43 268,-351.43 355,-351.43 355,-375.43"/>
<text text-anchor="middle" x="311.5" y="-361.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modchem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M286.8,-351.34C258.11,-338.55 209.27,-322.85 174,-343.43"/>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M276.25,-375.47C268.97,-379.15 261.75,-383.76 256,-389.43 213.88,-430.98 189.93,-498.61 179.81,-533.32"/>
<polygon fill="#025570" stroke="#025570" points="176.32,-532.79 177,-543.37 183.06,-534.68 176.32,-532.79"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M404.86,-528.58C363.6,-515.57 300.89,-491.61 256,-455.43 207.96,-416.72 227.28,-312.34 174,-343.43"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M407.09,-552.45C379.98,-558.68 343.67,-563.48 312.5,-555.43"/>
</g>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~modsave.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/modsave.f90.html" xlink:title="modsave.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="352.5,-733.43 270.5,-733.43 270.5,-709.43 352.5,-709.43 352.5,-733.43"/>
<text text-anchor="middle" x="311.5" y="-719.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modsave.f90</text>
</a>
</g>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#017525" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M436.4,-552.78C426.57,-564.22 412.37,-582.04 403,-599.43 380.39,-641.38 400.27,-666.31 367,-700.43 365.2,-702.27 363.23,-703.96 361.13,-705.49"/>
<polygon fill="#017525" fill-opacity="0.019608" stroke="#017525" stroke-opacity="0.019608" points="359.23,-702.55 352.51,-710.73 362.87,-708.53 359.23,-702.55"/>
</g>
<!-- sourcefile~modeb.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~modeb.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/modeb.f90.html" xlink:title="modEB.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="347,-977.43 276,-977.43 276,-953.43 347,-953.43 347,-977.43"/>
<text text-anchor="middle" x="311.5" y="-963.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modEB.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M275.8,-977.08C269.07,-979.81 262.19,-982.96 256,-986.43 215.92,-1008.92 212.4,-1074.68 174,-1049.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M172,-1049.43C90.26,-995.69 55.74,-666.45 47.83,-577.54"/>
<polygon fill="#255000" stroke="#255000" points="51.31,-577.15 46.96,-567.49 44.34,-577.76 51.31,-577.15"/>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M283.24,-953.32C274.41,-949.17 264.67,-944.32 256,-939.43 236.33,-928.33 215.06,-914.26 199.12,-903.27"/>
<polygon fill="transparent" stroke="transparent" points="201.06,-900.35 190.85,-897.51 197.06,-906.1 201.06,-900.35"/>
</g>
<!-- sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~modstat_nc.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/modstat_nc.f90.html" xlink:title="modstat_nc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="220,-195.43 126,-195.43 126,-171.43 220,-171.43 220,-195.43"/>
<text text-anchor="middle" x="173" y="-181.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modstat_nc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#070255" stroke-dasharray="5,2" d="M294.44,-953.35C281.52,-942.61 264.22,-925.66 256,-906.43 205.49,-788.3 243.48,-455.74 220,-329.43 211.6,-284.25 193.56,-233.5 182.74,-205.31"/>
<polygon fill="#070255" stroke="#070255" points="185.87,-203.71 178.98,-195.67 179.35,-206.26 185.87,-203.71"/>
</g>
<!-- sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~modfielddump.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/modfielddump.f90.html" xlink:title="modfielddump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="367,-215.43 256,-215.43 256,-191.43 367,-191.43 367,-215.43"/>
<text text-anchor="middle" x="311.5" y="-201.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modfielddump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M278.33,-215.5C270.56,-219.27 262.6,-223.92 256,-229.43 208.11,-269.46 227.91,-311.97 174,-343.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M172,-343.43C99.23,-385.89 63.89,-488.33 51.43,-533.46"/>
<polygon fill="#255000" stroke="#255000" points="47.97,-532.82 48.8,-543.39 54.74,-534.61 47.97,-532.82"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M295.94,-215.57C283.61,-226.6 266.33,-243.93 256,-262.43 229.21,-310.41 191.8,-473.92 178.73,-533.49"/>
<polygon fill="#025570" stroke="#025570" points="175.29,-532.84 176.58,-543.36 182.13,-534.33 175.29,-532.84"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#070255" stroke-dasharray="5,2" d="M255.77,-195.41C247.44,-194.19 238.82,-192.93 230.46,-191.7"/>
<polygon fill="#070255" stroke="#070255" points="230.81,-188.22 220.41,-190.23 229.79,-195.14 230.81,-188.22"/>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M130.39,-555.43C120.82,-555.43 110.49,-555.43 100.46,-555.43"/>
<polygon fill="#255000" stroke="#255000" points="100.16,-551.93 90.16,-555.43 100.16,-558.93 100.16,-551.93"/>
</g>
<!-- sourcefile~modforces.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~modforces.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/modforces.f90.html" xlink:title="modforces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="648,-455.43 559,-455.43 559,-431.43 648,-431.43 648,-455.43"/>
<text text-anchor="middle" x="603.5" y="-441.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modforces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M558.84,-433.9C548.51,-430.08 538.14,-424.77 530,-417.43 502.54,-392.67 524.23,-363.73 494,-342.43 427.7,-295.72 393.61,-323.49 312.5,-323.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M310.5,-323.43C249.19,-322.73 225.85,-310.7 174,-343.43"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M577.21,-455.5C547.42,-469.08 496.08,-490.54 449.5,-500.43"/>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M447.5,-500.43C439.58,-502.11 320.34,-557.44 312.5,-555.43"/>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M310.5,-555.43C283.04,-548.39 251.44,-547.93 225.56,-549.44"/>
<polygon fill="#025570" stroke="#025570" points="225.32,-545.95 215.58,-550.13 225.8,-552.93 225.32,-545.95"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M272.93,-793.59C244.89,-786.99 206.05,-776.25 174,-761.43"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M274.93,-813.43C268.48,-816.08 261.92,-819.11 256,-822.43 233.74,-834.93 210.9,-852.98 195,-866.56"/>
<polygon fill="transparent" stroke="transparent" points="192.61,-864 187.36,-873.2 197.21,-869.28 192.61,-864"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M297.04,-789.35C285.09,-778.1 267.76,-760.4 256,-742.43 219.78,-687.09 192.8,-613.08 180.83,-577.02"/>
<polygon fill="#025570" stroke="#025570" points="184.15,-575.92 177.73,-567.5 177.5,-578.09 184.15,-575.92"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M442.62,-632.73C432.32,-657.16 406.05,-712.03 367,-742.43 346.76,-758.19 337.43,-755.39 312.5,-761.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M310.5,-761.43C251.54,-775.71 229.07,-786.89 174,-761.43"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M426.9,-608.4C405.12,-595.72 373.08,-577.2 367,-574.43 343.65,-563.8 337.34,-561.85 312.5,-555.43"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#017525" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M438.07,-632.58C424.16,-649.78 396.6,-681.25 367,-700.43 364.44,-702.09 361.74,-703.64 358.95,-705.1"/>
<polygon fill="#017525" fill-opacity="0.019608" stroke="#017525" stroke-opacity="0.019608" points="357.4,-701.96 349.87,-709.42 360.4,-708.29 357.4,-701.96"/>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="801,-773.43 722,-773.43 722,-749.43 801,-749.43 801,-773.43"/>
<text text-anchor="middle" x="761.5" y="-759.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M721.89,-757C690.03,-754.39 643.84,-753.05 604.5,-761.43"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M731.11,-749.43C724.51,-745.7 718,-741.05 713,-735.43 684.64,-703.55 701.39,-681.44 677,-646.43 664.11,-627.93 645.15,-610.9 629.85,-598.78"/>
<polygon fill="transparent" stroke="transparent" points="631.85,-595.9 621.79,-592.57 627.58,-601.44 631.85,-595.9"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M744.39,-749.25C728.16,-737.51 702.01,-720.01 677,-709.43 561.44,-660.56 502.08,-718.41 403,-641.43 376.31,-620.69 392.71,-596.38 367,-574.43 347.49,-557.78 337.35,-561.8 312.5,-555.43"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M284.33,-733.51C250.52,-748.35 193.67,-770.52 174,-761.43"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M298.5,-733.82C287.24,-745.57 270.09,-763.85 256,-780.43 231.65,-809.09 205.15,-843.7 189.06,-865.14"/>
<polygon fill="transparent" stroke="transparent" points="186.21,-863.1 183.03,-873.2 191.82,-867.29 186.21,-863.1"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M270.27,-709.66C265.15,-707.12 260.22,-704.07 256,-700.43 216.66,-666.48 192.15,-608.75 181.03,-577.35"/>
<polygon fill="#025570" stroke="#025570" points="184.31,-576.12 177.77,-567.79 177.68,-578.38 184.31,-576.12"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="949,-495.43 855,-495.43 855,-471.43 949,-471.43 949,-495.43"/>
<text text-anchor="middle" x="902" y="-481.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M760.5,-620.43C672.23,-651.13 695.91,-741.96 604.5,-761.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M602.5,-761.43C535.99,-775.6 515.14,-743.67 449.5,-761.43"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M760.5,-620.43C750.13,-623.91 694.17,-608.2 652.21,-595.45"/>
<polygon fill="transparent" stroke="transparent" points="653.01,-592.03 642.43,-592.45 650.96,-598.73 653.01,-592.03"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#872550" stroke-dasharray="5,2" d="M602.5,-540.43C570.25,-530.51 532.34,-530.43 502.32,-532.87"/>
<polygon fill="#872550" stroke="#872550" points="501.68,-529.42 492.05,-533.83 502.33,-536.39 501.68,-529.42"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M760.5,-620.43C717.09,-635.53 718.51,-579.16 677,-559.43 646.91,-545.13 636.34,-550.23 604.5,-540.43"/>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M602.5,-540.43C602.24,-540.35 449.77,-500.37 449.5,-500.43"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#025512" stroke-dasharray="5,2" stroke-opacity="0.011765" d="M872.47,-471.36C844.91,-460.62 801.7,-446.21 762.5,-443.43"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#025522" stroke-dasharray="5,2" stroke-opacity="0.031373" d="M760.5,-620.43C672.02,-650.15 561.21,-639.73 498.59,-629.83"/>
<polygon fill="#025522" fill-opacity="0.031373" stroke="#025522" stroke-opacity="0.031373" points="499.02,-626.36 488.59,-628.19 497.89,-633.26 499.02,-626.36"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#022825" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M894.87,-495.73C873.28,-539.06 800.61,-684.93 773.14,-740.07"/>
<polygon fill="#022825" fill-opacity="0.019608" stroke="#022825" stroke-opacity="0.019608" points="769.89,-738.76 768.56,-749.27 776.15,-741.88 769.89,-738.76"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node23"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="810,-415.43 713,-415.43 713,-391.43 810,-391.43 810,-415.43"/>
<text text-anchor="middle" x="761.5" y="-401.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#870255" stroke-dasharray="5,2" d="M872.4,-471.36C863.71,-467.31 854.28,-462.52 846,-457.43 828.73,-446.81 826.94,-440.55 810,-429.43 805.38,-426.4 800.38,-423.39 795.42,-420.55"/>
<polygon fill="#870255" stroke="#870255" points="797.06,-417.46 786.62,-415.66 793.66,-423.58 797.06,-417.46"/>
</g>
<!-- sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~modthermodynamics.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node24"><a xlink:href=".././sourcefile/modthermodynamics.f90.html" xlink:title="modthermodynamics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="677,-512.43 530,-512.43 530,-488.43 677,-488.43 677,-512.43"/>
<text text-anchor="middle" x="603.5" y="-498.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modthermodynamics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#140025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M894.02,-495.8C876.54,-525.23 827.58,-598.57 762.5,-620.43"/>
<path fill="none" stroke="#140025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M760.5,-620.43C707.53,-638.22 723.3,-557.72 677,-526.43 671.34,-522.61 665.06,-519.27 658.62,-516.39"/>
<polygon fill="#140025" fill-opacity="0.019608" stroke="#140025" stroke-opacity="0.019608" points="659.72,-513.05 649.14,-512.48 657.05,-519.52 659.72,-513.05"/>
</g>
<!-- sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M167.81,-195.81C149.57,-249.66 76.98,-463.96 53.42,-533.51"/>
<polygon fill="#255000" stroke="#255000" points="49.97,-532.79 50.08,-543.38 56.6,-535.03 49.97,-532.79"/>
</g>
<!-- sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~modstatistics.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/modstatistics.f90.html" xlink:title="modstatistics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-135.43 260,-135.43 260,-111.43 363,-111.43 363,-135.43"/>
<text text-anchor="middle" x="311.5" y="-121.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modstatistics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M301.53,-111.21C279.68,-82.97 221.94,-17.65 174,-45.43"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M295.37,-135.61C282.85,-146.54 265.62,-163.7 256,-182.43 219.73,-253.07 236.99,-279.86 220,-357.43 205.98,-421.48 188.08,-496.84 179.32,-533.37"/>
<polygon fill="#025570" stroke="#025570" points="175.84,-532.86 176.91,-543.4 182.65,-534.5 175.84,-532.86"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#070255" stroke-dasharray="5,2" d="M282.88,-135.57C262.16,-144.68 233.58,-157.24 210.9,-167.21"/>
<polygon fill="#070255" stroke="#070255" points="209.33,-164.08 201.58,-171.31 212.14,-170.49 209.33,-164.08"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node22"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="958,-415.43 846,-415.43 846,-391.43 958,-391.43 958,-415.43"/>
<text text-anchor="middle" x="902" y="-401.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M900.78,-391.34C899.11,-339.98 884.71,-140.07 762.5,-83.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M760.5,-83.43C695.75,-53.43 675.73,-49.7 604.5,-45.43"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M602.5,-215.43C526.63,-262.44 562.17,-326.81 494,-384.43 477.58,-398.31 468.1,-392.64 449.5,-403.43"/>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M447.5,-403.43C360.58,-453.87 256.47,-510.78 205.4,-538.47"/>
<polygon fill="#025570" stroke="#025570" points="203.62,-535.46 196.49,-543.3 206.95,-541.61 203.62,-535.46"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#070255" stroke-dasharray="5,2" d="M447.5,-163.43C373.82,-145.84 286.09,-157.84 230.23,-169.44"/>
<polygon fill="#070255" stroke="#070255" points="229.22,-166.08 220.18,-171.6 230.69,-172.92 229.22,-166.08"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90</title>
<path fill="none" stroke="#017255" stroke-dasharray="5,2" d="M760.5,-83.43C678.1,-45.24 681.71,-167.59 604.5,-215.43"/>
<path fill="none" stroke="#017255" stroke-dasharray="5,2" d="M602.5,-215.43C541.45,-253.26 519.36,-180.11 449.5,-163.43"/>
<path fill="none" stroke="#017255" stroke-dasharray="5,2" d="M447.5,-163.43C417.67,-156.31 384.65,-146.56 358.73,-138.47"/>
<polygon fill="#017255" stroke="#017255" points="359.76,-135.12 349.17,-135.46 357.66,-141.8 359.76,-135.12"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#870255" stroke-dasharray="5,2" d="M845.86,-403.43C837.5,-403.43 828.84,-403.43 820.42,-403.43"/>
<polygon fill="#870255" stroke="#870255" points="820.29,-399.93 810.29,-403.43 820.29,-406.93 820.29,-399.93"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M712.99,-407.86C681.88,-409.68 640.46,-410.04 604.5,-403.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M602.5,-403.43C540.32,-392 548.37,-343.71 494,-311.43 441.98,-280.55 426.48,-273.51 367,-262.43 318.5,-253.4 301.64,-243.69 256,-262.43 208.61,-281.89 217.32,-316.08 174,-343.43"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M757.07,-415.52C748.43,-443.87 723.09,-515.22 677,-554.43 672.74,-558.06 667.93,-561.2 662.86,-563.91"/>
<polygon fill="transparent" stroke="transparent" points="661.07,-560.88 653.54,-568.33 664.08,-567.2 661.07,-560.88"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M602.5,-403.43C535.62,-391.13 508.31,-369.3 449.5,-403.43"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M560.2,-488.37C494.21,-469.08 363.23,-428.93 256,-384.43 218.37,-368.81 208.85,-322.32 174,-343.43"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M529.86,-494.28C504.22,-493.72 475.35,-494.94 449.5,-500.43"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node25"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1073,-455.43 994,-455.43 994,-431.43 1073,-431.43 1073,-455.43"/>
<text text-anchor="middle" x="1033.5" y="-441.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M1030.58,-431.34C1019.15,-364.17 954.05,-39.98 762.5,-45.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M760.5,-45.43C693.34,-28.19 673.71,-49.58 604.5,-45.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M602.5,-45.43C412.4,-34.04 338.78,50.06 174,-45.43"/>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M172,-45.43C88.4,-101.93 55.18,-441.77 47.71,-532.94"/>
<polygon fill="#255000" stroke="#255000" points="44.21,-532.76 46.91,-543.01 51.19,-533.32 44.21,-532.76"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M602.5,-885.43C533.44,-898.5 518.4,-911.55 449.5,-925.43"/>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M447.5,-925.43C388.68,-937.28 372.36,-929.51 312.5,-925.43"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M1031.91,-455.7C1028.84,-504.47 1010.33,-685.55 903,-761.43"/>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M901,-761.43C875.32,-779.59 694.57,-647.93 628.56,-598.59"/>
<polygon fill="transparent" stroke="transparent" points="630.49,-595.66 620.39,-592.47 626.29,-601.26 630.49,-595.66"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M447.5,-247.43C411.3,-240.33 370.47,-254.37 343.29,-266.94"/>
<polygon fill="transparent" stroke="transparent" points="341.76,-263.79 334.27,-271.29 344.8,-270.1 341.76,-263.79"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90</title>
<path fill="none" stroke="#352550" stroke-dasharray="5,2" d="M447.5,-925.43C416.69,-931.64 382.77,-941.7 356.64,-950.18"/>
<polygon fill="#352550" stroke="#352550" points="355.44,-946.89 347.03,-953.34 357.63,-953.54 355.44,-946.89"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90</title>
<path fill="none" stroke="#025517" stroke-dasharray="5,2" d="M993.85,-445.61C968.04,-446.54 933.4,-446.74 903,-443.43"/>
<path fill="none" stroke="#025517" stroke-dasharray="5,2" d="M901,-443.43C875.29,-440.63 867.38,-438.98 846,-424.43 825.67,-410.6 830.15,-396.52 810,-382.43 669.79,-284.39 617.39,-280.35 449.5,-247.43"/>
<path fill="none" stroke="#025517" stroke-dasharray="5,2" d="M447.5,-247.43C413,-242.86 375.5,-229.95 348.8,-219.29"/>
<polygon fill="#025517" stroke="#025517" points="350.06,-216.02 339.48,-215.48 347.41,-222.5 350.06,-216.02"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#025512" stroke-dasharray="5,2" stroke-opacity="0.011765" d="M901,-443.43C839.74,-437.44 823.9,-447.78 762.5,-443.43"/>
<path fill="none" stroke="#025512" stroke-dasharray="5,2" stroke-opacity="0.011765" d="M760.5,-443.43C726.67,-441.03 688.6,-440.98 658.54,-441.56"/>
<polygon fill="#025512" fill-opacity="0.011765" stroke="#025512" stroke-opacity="0.011765" points="658.19,-438.06 648.27,-441.78 658.34,-445.06 658.19,-438.06"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#025517" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M760.5,-823.43C686.81,-835.12 677.81,-871.56 604.5,-885.43"/>
<path fill="none" stroke="#025517" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M602.5,-885.43C578.19,-890.03 432.04,-842.17 356.96,-816.72"/>
<polygon fill="#025517" fill-opacity="0.019608" stroke="#025517" stroke-opacity="0.019608" points="357.89,-813.34 347.3,-813.43 355.64,-819.96 357.89,-813.34"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#022825" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M901,-761.43C875.27,-779.62 839.59,-779.19 810.89,-774.43"/>
<polygon fill="#022825" fill-opacity="0.019608" stroke="#022825" stroke-opacity="0.019608" points="811.53,-770.99 801.05,-772.59 810.24,-777.87 811.53,-770.99"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#017525" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M901,-761.43C844.58,-798.38 829.21,-813.49 762.5,-823.43"/>
<path fill="none" stroke="#017525" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M760.5,-823.43C710.87,-830.83 722.79,-767.95 677,-747.43 573.12,-700.88 435.8,-706.81 362.94,-714.52"/>
<polygon fill="#017525" fill-opacity="0.019608" stroke="#017525" stroke-opacity="0.019608" points="362.23,-711.08 352.67,-715.67 363,-718.04 362.23,-711.08"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#012325" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M994,-455.32C980.8,-459.4 965.85,-464.02 951.93,-468.32"/>
<polygon fill="#012325" fill-opacity="0.019608" stroke="#012325" stroke-opacity="0.019608" points="950.55,-465.08 942.03,-471.38 952.61,-471.77 950.55,-465.08"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#070255" stroke-dasharray="5,2" d="M760.5,-45.43C722.94,-47.68 714.29,-54.41 677,-59.43 490.6,-84.55 426.13,-22.23 256,-102.43 227.28,-115.97 202.65,-143.85 188.09,-163.09"/>
<polygon fill="#070255" stroke="#070255" points="185.2,-161.1 182.12,-171.24 190.85,-165.23 185.2,-161.1"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#350255" stroke-dasharray="5,2" d="M994,-431.54C980.8,-427.46 965.85,-422.84 951.93,-418.55"/>
<polygon fill="#350255" stroke="#350255" points="952.61,-415.09 942.03,-415.49 950.55,-421.78 952.61,-415.09"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#870255" stroke-dasharray="5,2" d="M901,-443.43C866.61,-440.07 829.04,-428.7 801.71,-418.94"/>
<polygon fill="#870255" stroke="#870255" points="802.73,-415.58 792.13,-415.43 800.32,-422.16 802.73,-415.58"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#140025" stroke-dasharray="5,2" stroke-opacity="0.019608" d="M901,-443.43C889.64,-442.32 756.5,-469.1 672.54,-486.34"/>
<polygon fill="#140025" fill-opacity="0.019608" stroke="#140025" stroke-opacity="0.019608" points="671.64,-482.95 662.55,-488.39 673.05,-489.81 671.64,-482.95"/>
</g>
<!-- sourcefile~scalsource.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~scalsource.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node26"><a xlink:href=".././sourcefile/scalsource.f90.html" xlink:title="scalsource.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="356,-855.43 267,-855.43 267,-831.43 356,-831.43 356,-855.43"/>
<text text-anchor="middle" x="311.5" y="-841.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">scalsource.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M274.97,-831.35C268.52,-828.71 261.95,-825.71 256,-822.43 216.22,-800.51 215.23,-780.49 174,-761.43"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M271.38,-855.47C254.13,-860.78 233.82,-867.03 216.22,-872.44"/>
<polygon fill="transparent" stroke="transparent" points="214.75,-869.23 206.22,-875.52 216.8,-875.92 214.75,-869.23"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M267.6,-831.42C263.31,-828.95 259.32,-825.99 256,-822.43 221.9,-785.86 189.52,-634.91 178.22,-577.62"/>
<polygon fill="#025570" stroke="#025570" points="181.59,-576.62 176.25,-567.47 174.72,-577.96 181.59,-576.62"/>
</g>
<!-- sourcefile~tstep.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~tstep.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node27"><a xlink:href=".././sourcefile/tstep.f90.html" xlink:title="tstep.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="478,-375.43 419,-375.43 419,-351.43 478,-351.43 478,-375.43"/>
<text text-anchor="middle" x="448.5" y="-361.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">tstep.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M422.28,-351.22C395.64,-339.47 352.1,-323.46 312.5,-323.43"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M418.87,-363.43C403.33,-363.43 383.63,-363.43 365.42,-363.43"/>
<polygon fill="transparent" stroke="transparent" points="365.2,-359.93 355.2,-363.43 365.2,-366.93 365.2,-359.93"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#025570" stroke-dasharray="5,2" d="M418.75,-375.03C379.63,-391.61 308.5,-424.63 256,-465.43 229.54,-485.99 204.4,-515.61 189.1,-535.17"/>
<polygon fill="#025570" stroke="#025570" points="186.3,-533.07 182.98,-543.14 191.85,-537.34 186.3,-533.07"/>
</g>
<!-- sourcefile~wf_gr.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~wf_gr.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node28"><a xlink:href=".././sourcefile/wf_gr.f90.html" xlink:title="wf_gr.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="341.5,-1061.43 281.5,-1061.43 281.5,-1037.43 341.5,-1037.43 341.5,-1061.43"/>
<text text-anchor="middle" x="311.5" y="-1047.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wf_gr.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M281.23,-1058.09C251.65,-1064.99 205.88,-1070.39 174,-1049.43"/>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M281.34,-1042.3C272.5,-1039.12 263.23,-1034.64 256,-1028.43 217.14,-995.1 192.54,-938.51 181.26,-907.46"/>
<polygon fill="transparent" stroke="transparent" points="184.42,-905.9 177.82,-897.62 177.81,-908.21 184.42,-905.9"/>
</g>
<!-- sourcefile~wf_uno.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~wf_uno.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node29"><a xlink:href=".././sourcefile/wf_uno.f90.html" xlink:title="wf_uno.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="346.5,-1019.43 276.5,-1019.43 276.5,-995.43 346.5,-995.43 346.5,-1019.43"/>
<text text-anchor="middle" x="311.5" y="-1005.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wf_uno.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M276.47,-1019.33C237.5,-1032.74 178.42,-1052.33 174,-1049.43"/>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M276.23,-997.37C269.19,-994.46 262.07,-990.84 256,-986.43 225.94,-964.59 200.65,-929.12 186.42,-906.55"/>
<polygon fill="transparent" stroke="transparent" points="189.23,-904.43 181.01,-897.74 183.26,-908.09 189.23,-904.43"/>
</g>
<!-- sourcefile~wfmneutral.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~wfmneutral.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node30"><a xlink:href=".././sourcefile/wfmneutral.f90.html" xlink:title="wfmneutral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358.5,-897.43 264.5,-897.43 264.5,-873.43 358.5,-873.43 358.5,-897.43"/>
<text text-anchor="middle" x="311.5" y="-883.03" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">wfmneutral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#255000" stroke-dasharray="5,2" d="M271.63,-873.42C266.13,-870.89 260.74,-867.91 256,-864.43 208.83,-829.81 227.11,-785.99 174,-761.43"/>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="transparent" stroke-dasharray="5,2" d="M264.29,-885.43C248.83,-885.43 231.68,-885.43 216.52,-885.43"/>
<polygon fill="transparent" stroke="transparent" points="216.38,-881.93 206.38,-885.43 216.38,-888.93 216.38,-881.93"/>
</g>
</g>
</svg>
</div>                <script>
                  var pansourcefilemodglobalf90AfferentGraph = svgPanZoom('#sourcefilemodglobalf90AfferentGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>        <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
          <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                </div>
              <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.50.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="193.5,-24 88.5,-24 88.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a file to a file which it depends on. A file
is dependent upon another if the latter must be compiled before the former
can be.
</p>
 Where possible, edges connecting nodes are
given different colours to make them easier to distinguish in
large graphs.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
<br>
    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
      <div class="panel panel-primary">
      <div class="panel-heading text-left">
        <h3 class="panel-title">
          <a data-toggle="collapse" href="#mods-1">Modules</a>
        </h3>
      </div>
      <div id="mods-1" class="panel-collapse collapse">
        <div class="list-group">
            <a class="list-group-item" href="../module/modglobal.html">modglobal</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="panel panel-primary">
      <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../sourcefile/modglobal.f90.html#src">modglobal.f90</a>
      </div>
    </div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a id="ln-1" name="ln-1" href="#ln-1"></a><span class="c">!&gt; \file modglobal.f90</span>
<a id="ln-2" name="ln-2" href="#ln-2"></a><span class="c">!!  Declares the global constants</span>
<a id="ln-3" name="ln-3" href="#ln-3"></a>
<a id="ln-4" name="ln-4" href="#ln-4"></a><span class="c">!&gt;</span>
<a id="ln-5" name="ln-5" href="#ln-5"></a><span class="c">!! \author Jasper Tomas, TU Delft 31 March 2014</span>
<a id="ln-6" name="ln-6" href="#ln-6"></a>
<a id="ln-7" name="ln-7" href="#ln-7"></a><span class="c">!!  Declares the global constants</span>
<a id="ln-8" name="ln-8" href="#ln-8"></a><span class="c">!&gt;</span>
<a id="ln-9" name="ln-9" href="#ln-9"></a><span class="c">!  This file is part of DALES.</span>
<a id="ln-10" name="ln-10" href="#ln-10"></a><span class="c">!</span>
<a id="ln-11" name="ln-11" href="#ln-11"></a><span class="c">! DALES is free software; you can redistribute it and/or modify</span>
<a id="ln-12" name="ln-12" href="#ln-12"></a><span class="c">! it under the terms of the GNU General Public License as published by</span>
<a id="ln-13" name="ln-13" href="#ln-13"></a><span class="c">! the Free Software Foundation; either version 3 of the License, or</span>
<a id="ln-14" name="ln-14" href="#ln-14"></a><span class="c">! (at your option) any later version.</span>
<a id="ln-15" name="ln-15" href="#ln-15"></a><span class="c">!</span>
<a id="ln-16" name="ln-16" href="#ln-16"></a><span class="c">! DALES is distributed in the hope that it will be useful,</span>
<a id="ln-17" name="ln-17" href="#ln-17"></a><span class="c">! but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a id="ln-18" name="ln-18" href="#ln-18"></a><span class="c">! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a id="ln-19" name="ln-19" href="#ln-19"></a><span class="c">! GNU General Public License for more details.</span>
<a id="ln-20" name="ln-20" href="#ln-20"></a><span class="c">!</span>
<a id="ln-21" name="ln-21" href="#ln-21"></a><span class="c">! You should have received a copy of the GNU General Public License</span>
<a id="ln-22" name="ln-22" href="#ln-22"></a><span class="c">! along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a id="ln-23" name="ln-23" href="#ln-23"></a><span class="c">!</span>
<a id="ln-24" name="ln-24" href="#ln-24"></a><span class="c">!  Copyright 1993-2009 Delft University of Technology, Wageningen University, Utrecht University, KNMI</span>
<a id="ln-25" name="ln-25" href="#ln-25"></a><span class="c">!</span>
<a id="ln-26" name="ln-26" href="#ln-26"></a><span class="k">module </span><span class="n">modglobal</span><span class="w"></span>
<a id="ln-27" name="ln-27" href="#ln-27"></a>
<a id="ln-28" name="ln-28" href="#ln-28"></a><span class="w">   </span><span class="k">implicit none</span>
<a id="ln-29" name="ln-29" href="#ln-29"></a><span class="k">   save</span>
<a id="ln-30" name="ln-30" href="#ln-30"></a>
<a id="ln-31" name="ln-31" href="#ln-31"></a><span class="k">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">poisrcheck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">! switch to check if it is the first (RK) time step</span>
<a id="ln-32" name="ln-32" href="#ln-32"></a><span class="w">   </span><span class="c">! Simulation dimensions (parconst.f90)</span>
<a id="ln-33" name="ln-33" href="#ln-33"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">imax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">64</span><span class="w"></span>
<a id="ln-34" name="ln-34" href="#ln-34"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jtot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">64</span><span class="w"></span>
<a id="ln-35" name="ln-35" href="#ln-35"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jmax</span><span class="w"></span>
<a id="ln-36" name="ln-36" href="#ln-36"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">jsen</span><span class="w"></span>
<a id="ln-37" name="ln-37" href="#ln-37"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">kmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">96</span><span class="w"></span>
<a id="ln-38" name="ln-38" href="#ln-38"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">isen</span><span class="w"></span>
<a id="ln-39" name="ln-39" href="#ln-39"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">ib</span><span class="w"></span>
<a id="ln-40" name="ln-40" href="#ln-40"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">ie</span><span class="w"></span>
<a id="ln-41" name="ln-41" href="#ln-41"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">jb</span><span class="w"></span>
<a id="ln-42" name="ln-42" href="#ln-42"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">je</span><span class="w"></span>
<a id="ln-43" name="ln-43" href="#ln-43"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">jgb</span><span class="w"> </span><span class="c">! global j range</span>
<a id="ln-44" name="ln-44" href="#ln-44"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">jge</span><span class="w"> </span><span class="c">! global j range</span>
<a id="ln-45" name="ln-45" href="#ln-45"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">offset</span><span class="w"></span>
<a id="ln-46" name="ln-46" href="#ln-46"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">kb</span><span class="w"></span>
<a id="ln-47" name="ln-47" href="#ln-47"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">ke</span><span class="w"></span>
<a id="ln-48" name="ln-48" href="#ln-48"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">nsv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">!&lt; Number of additional scalar fields</span>
<a id="ln-49" name="ln-49" href="#ln-49"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">nvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-50" name="ln-50" href="#ln-50"></a><span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fieldvars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>
<a id="ln-51" name="ln-51" href="#ln-51"></a>
<a id="ln-52" name="ln-52" href="#ln-52"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">ih</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-53" name="ln-53" href="#ln-53"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">jh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-54" name="ln-54" href="#ln-54"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">kh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-55" name="ln-55" href="#ln-55"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">ihc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c">! used in k-scheme</span>
<a id="ln-56" name="ln-56" href="#ln-56"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">jhc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c">! used in k-scheme</span>
<a id="ln-57" name="ln-57" href="#ln-57"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">khc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c">! used in k-scheme</span>
<a id="ln-58" name="ln-58" href="#ln-58"></a>
<a id="ln-59" name="ln-59" href="#ln-59"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nblocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">! no. of blocks in IBM</span>
<a id="ln-60" name="ln-60" href="#ln-60"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="k">block</span><span class="p">(:,:)</span><span class="w"></span>
<a id="ln-61" name="ln-61" href="#ln-61"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nfcts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="c">! no. of wall facets</span>
<a id="ln-62" name="ln-62" href="#ln-62"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">iplane</span><span class="w"> </span><span class="c">! ib+iplane is the plane that is stored when lstoreplane=.true.</span>
<a id="ln-63" name="ln-63" href="#ln-63"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">nstore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1002</span><span class="w"> </span><span class="c">! number of rk steps in inletfile. This should be a multiple of three!</span>
<a id="ln-64" name="ln-64" href="#ln-64"></a><span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fname_options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;namoptions&#39;</span><span class="w"></span>
<a id="ln-65" name="ln-65" href="#ln-65"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">longint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<a id="ln-66" name="ln-66" href="#ln-66"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lwarmstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;   flag for &quot;cold&quot; or &quot;warm&quot; start</span>
<a id="ln-67" name="ln-67" href="#ln-67"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lstratstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<a id="ln-68" name="ln-68" href="#ln-68"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lfielddump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt; switch to enable the fielddump</span>
<a id="ln-69" name="ln-69" href="#ln-69"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lreadscal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;   flag for reading scalar pollutant field (warm start)</span>
<a id="ln-70" name="ln-70" href="#ln-70"></a>
<a id="ln-71" name="ln-71" href="#ln-71"></a><span class="w">   </span><span class="c">!Switches for boundary conditions</span>
<a id="ln-72" name="ln-72" href="#ln-72"></a><span class="w">   </span><span class="c">!momentum (m), temperature (T), humidity (q) and scalars (s)</span>
<a id="ln-73" name="ln-73" href="#ln-73"></a><span class="w">   </span><span class="c">!lateral in x/i direction (x), in y/j direction (y) at the top (top) and at the bottom (bot)</span>
<a id="ln-74" name="ln-74" href="#ln-74"></a><span class="w">   </span><span class="c">!1 = periodic, &gt;1 special in/outflow conditions</span>
<a id="ln-75" name="ln-75" href="#ln-75"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCxm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-76" name="ln-76" href="#ln-76"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCxT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-77" name="ln-77" href="#ln-77"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCxq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-78" name="ln-78" href="#ln-78"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCxs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-79" name="ln-79" href="#ln-79"></a><span class="w">   </span>
<a id="ln-80" name="ln-80" href="#ln-80"></a><span class="w">   </span><span class="c">!y direction is currently alway periodic</span>
<a id="ln-81" name="ln-81" href="#ln-81"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCym</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-82" name="ln-82" href="#ln-82"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCyT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-83" name="ln-83" href="#ln-83"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCyq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-84" name="ln-84" href="#ln-84"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-85" name="ln-85" href="#ln-85"></a>
<a id="ln-86" name="ln-86" href="#ln-86"></a><span class="w">   </span><span class="c">!at the top (top)</span>
<a id="ln-87" name="ln-87" href="#ln-87"></a><span class="w">   </span><span class="c">!1 = freeslip, 2 = noslip, 3 = determined by inflow conditions</span>
<a id="ln-88" name="ln-88" href="#ln-88"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCtopm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-89" name="ln-89" href="#ln-89"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCtopT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-90" name="ln-90" href="#ln-90"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCtopq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-91" name="ln-91" href="#ln-91"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCtops</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-92" name="ln-92" href="#ln-92"></a>
<a id="ln-93" name="ln-93" href="#ln-93"></a><span class="w">   </span><span class="c">!at the bottom (bot) !the bottom BC are defacto useless, since they will be covered by a road facet</span>
<a id="ln-94" name="ln-94" href="#ln-94"></a><span class="w">   </span><span class="c">!1 = flux, 2 = wall function</span>
<a id="ln-95" name="ln-95" href="#ln-95"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCbotm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-96" name="ln-96" href="#ln-96"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCbotT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-97" name="ln-97" href="#ln-97"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCbotq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-98" name="ln-98" href="#ln-98"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BCbots</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-99" name="ln-99" href="#ln-99"></a>
<a id="ln-100" name="ln-100" href="#ln-100"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iinletgen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">!&lt;  0: no inletgen, 1: turb. inlet generator (Lund (1998)), 2: read inlet from file</span>
<a id="ln-101" name="ln-101" href="#ln-101"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">idriver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">!&lt;  0: no inlet driver store, 1: Save inlet driver data, 2: read inlet driver data from file</span>
<a id="ln-102" name="ln-102" href="#ln-102"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">linoutflow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch for periodic BC in both horizontal directions (false) or inflow/outflow in i and periodic in j.</span>
<a id="ln-103" name="ln-103" href="#ln-103"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lzerogradtop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch for zero gradient BC&#39;s at top wall (iinletgen 1 and 2 are seperate).</span>
<a id="ln-104" name="ln-104" href="#ln-104"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lzerogradtopscal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!</span>
<a id="ln-105" name="ln-105" href="#ln-105"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lbuoyancy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch for buoyancy force in modforces</span>
<a id="ln-106" name="ln-106" href="#ln-106"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ltempeq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch for solving temperature equation (either with or without buoyancy term)</span>
<a id="ln-107" name="ln-107" href="#ln-107"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lscalrec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;</span>
<a id="ln-108" name="ln-108" href="#ln-108"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lSIRANEinout</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  </span>
<a id="ln-109" name="ln-109" href="#ln-109"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ltempinout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  seperate switch for inflow/outflow BC for temperature (only necessary when linoutflow.eqv..false.).</span>
<a id="ln-110" name="ln-110" href="#ln-110"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lmoistinout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  seperate switch for inflow/outflow BC for moisture (only necessary when linoutflow.eqv..false.).</span>
<a id="ln-111" name="ln-111" href="#ln-111"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lper2inout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines type of restart: .true. means switching from periodic to in/outflow: inlet profile is read from prof.inp</span>
<a id="ln-112" name="ln-112" href="#ln-112"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">libm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether the Immersed Boundary Method is turned on</span>
<a id="ln-113" name="ln-113" href="#ln-113"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lwalldist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether the wall distances should be computed</span>
<a id="ln-114" name="ln-114" href="#ln-114"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether the subgrid model is turned on or constant ekm and ekh are used (DNS)</span>
<a id="ln-115" name="ln-115" href="#ln-115"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">linletRA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether a Running Average should be used (.true.) in inlet generator</span>
<a id="ln-116" name="ln-116" href="#ln-116"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lfixinlet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether the average inlet profiles can evolve or not (only used when iinletgen=1,2)</span>
<a id="ln-117" name="ln-117" href="#ln-117"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lfixutauin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether the utau is kept fixed at the inlet (only used when iinletgen=1,2)</span>
<a id="ln-118" name="ln-118" href="#ln-118"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lscasrc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!</span>
<a id="ln-119" name="ln-119" href="#ln-119"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lscasrcl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!tg3315</span>
<a id="ln-120" name="ln-120" href="#ln-120"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lydump</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">  </span><span class="c">!&lt;  switch to output y-averaged statistics every tsample</span>
<a id="ln-121" name="ln-121" href="#ln-121"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lytdump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">  </span><span class="c">!&lt;  switch to output y- and time- averaged statistics every tstatsdump</span>
<a id="ln-122" name="ln-122" href="#ln-122"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lxydump</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">  </span><span class="c">!&lt;  switch to output x- and y-avewraged statistics every tsample</span>
<a id="ln-123" name="ln-123" href="#ln-123"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lxytdump</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">  </span><span class="c">!&lt;  switch to output x-, y- and time-averaged statistics every tstatsdump</span>
<a id="ln-124" name="ln-124" href="#ln-124"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lscasrcr</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">  </span><span class="c">!&lt;  switch for network of point sources at lowest level</span>
<a id="ln-125" name="ln-125" href="#ln-125"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ltkedump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!tg3315</span>
<a id="ln-126" name="ln-126" href="#ln-126"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lslicedump</span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">  </span><span class="c">!&lt;  switch to output slices in the xy-plane every tstatsdump</span>
<a id="ln-127" name="ln-127" href="#ln-127"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ltdump</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">      </span><span class="c">!&lt;  switch to output time-averaged statistics every tstatsdump</span>
<a id="ln-128" name="ln-128" href="#ln-128"></a>
<a id="ln-129" name="ln-129" href="#ln-129"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lreadminl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch for reading mean inlet/recycle plane profiles (used in inletgenerator)</span>
<a id="ln-130" name="ln-130" href="#ln-130"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lwallfunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether wall functions are used to compute the wall-shear stress</span>
<a id="ln-131" name="ln-131" href="#ln-131"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">luoutflowr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed outflow rate</span>
<a id="ln-132" name="ln-132" href="#ln-132"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lvoutflowr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed outflow rate</span>
<a id="ln-133" name="ln-133" href="#ln-133"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">luvolflowr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed volume flow rate</span>
<a id="ln-134" name="ln-134" href="#ln-134"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lvvolflowr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed volume flow rate</span>
<a id="ln-135" name="ln-135" href="#ln-135"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lstoreplane</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether i-plane data is stored.</span>
<a id="ln-136" name="ln-136" href="#ln-136"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lstorexy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!xy files stored</span>
<a id="ln-137" name="ln-137" href="#ln-137"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lreadmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch that determines whether mean variables should be read from means#myid#.#expnr#</span>
<a id="ln-138" name="ln-138" href="#ln-138"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="nb">lstat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<a id="ln-139" name="ln-139" href="#ln-139"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lEB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<a id="ln-140" name="ln-140" href="#ln-140"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lwriteEBfiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<a id="ln-141" name="ln-141" href="#ln-141"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lconstW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">  </span><span class="c">! The evaporated water can be removed from the soil (lconstW=false) or the soil moisture can be assumed as constant in time (lconstW=true)</span>
<a id="ln-142" name="ln-142" href="#ln-142"></a><span class="c">!  logical :: ifixuinf   = .true. !dpdxl relaxed to have Uinf 1. dpdx = (1/dt)*(Uh-Uinf)2. d/dt(dpdx) = 1/tau*(Uh-Uinf)</span>
<a id="ln-143" name="ln-143" href="#ln-143"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ifixuinf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-144" name="ln-144" href="#ln-144"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lvinf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!use Vinf instead of Uinf for the fixed velocity at infinity</span>
<a id="ln-145" name="ln-145" href="#ln-145"></a>
<a id="ln-146" name="ln-146" href="#ln-146"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">freestreamav</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!</span>
<a id="ln-147" name="ln-147" href="#ln-147"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">freestrtmpav</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!</span>
<a id="ln-148" name="ln-148" href="#ln-148"></a><span class="w">   </span><span class="c">!&lt;  Global constants modconst.f90</span>
<a id="ln-149" name="ln-149" href="#ln-149"></a><span class="w">   </span><span class="c">!&lt; File numbers</span>
<a id="ln-150" name="ln-150" href="#ln-150"></a>
<a id="ln-151" name="ln-151" href="#ln-151"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ifinput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-152" name="ln-152" href="#ln-152"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ifoutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-153" name="ln-153" href="#ln-153"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ifnamopt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-154" name="ln-154" href="#ln-154"></a>
<a id="ln-155" name="ln-155" href="#ln-155"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.141592653589793116</span><span class="w"></span>
<a id="ln-156" name="ln-156" href="#ln-156"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grav</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">9.81</span><span class="w"> </span><span class="c">!&lt;    *gravity acceleration.</span>
<a id="ln-157" name="ln-157" href="#ln-157"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">28</span><span class="mf">7.04</span><span class="w"> </span><span class="c">!&lt;    *gas constant for dry air.</span>
<a id="ln-158" name="ln-158" href="#ln-158"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">46</span><span class="mf">1.5</span><span class="w"> </span><span class="c">!&lt;    *gas constant for water vapor.</span>
<a id="ln-159" name="ln-159" href="#ln-159"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="mf">4.</span><span class="w"> </span><span class="c">!&lt;    *specific heat at constant pressure (dry air).</span>
<a id="ln-160" name="ln-160" href="#ln-160"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rlv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.26e6</span><span class="w"> </span><span class="c">!&lt;    *latent heat for vaporisation.</span>
<a id="ln-161" name="ln-161" href="#ln-161"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rlvi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="n">rlv</span><span class="w"> </span><span class="c">!inverse</span>
<a id="ln-162" name="ln-162" href="#ln-162"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rd</span><span class="o">/</span><span class="n">rv</span><span class="w"> </span><span class="c">!&lt;    0.622</span>
<a id="ln-163" name="ln-163" href="#ln-163"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ep2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rv</span><span class="o">/</span><span class="n">rd</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="c">!&lt;    0.61</span>
<a id="ln-164" name="ln-164" href="#ln-164"></a><span class="w">   </span><span class="c">!&lt; real,parameter :: cv       = cp-rd            !&lt;    716.96</span>
<a id="ln-165" name="ln-165" href="#ln-165"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rcp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rd</span><span class="o">/</span><span class="n">cp</span><span class="w"> </span><span class="c">!&lt;    0.286</span>
<a id="ln-166" name="ln-166" href="#ln-166"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">cpr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cp</span><span class="o">/</span><span class="n">rd</span><span class="w"> </span><span class="c">!&lt;    3.50</span>
<a id="ln-167" name="ln-167" href="#ln-167"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rlvocp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rlv</span><span class="o">/</span><span class="n">cp</span><span class="w"> </span><span class="c">!&lt;    2.49</span>
<a id="ln-168" name="ln-168" href="#ln-168"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mair</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="mf">8.967</span><span class="w"> </span><span class="c">!&lt; Molar mass of air</span>
<a id="ln-169" name="ln-169" href="#ln-169"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rhoa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="c">!density of air used in some calculations</span>
<a id="ln-170" name="ln-170" href="#ln-170"></a>
<a id="ln-171" name="ln-171" href="#ln-171"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wfc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">31</span><span class="mf">3.</span><span class="w"> </span><span class="c">!water content at field capacity (kg/m3)</span>
<a id="ln-172" name="ln-172" href="#ln-172"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wwilt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">17</span><span class="mf">1.</span><span class="w"> </span><span class="c">!water ocntent at wilting point (kg/m3)</span>
<a id="ln-173" name="ln-173" href="#ln-173"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wgrmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">45</span><span class="mf">0.</span><span class="w"> </span><span class="c">!maximum water content (kg/m3)</span>
<a id="ln-174" name="ln-174" href="#ln-174"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rsmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="mf">0.</span><span class="w"> </span><span class="c">!minimum resistance of soil/plant</span>
<a id="ln-175" name="ln-175" href="#ln-175"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rsmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">500</span><span class="mf">0.</span><span class="w"> </span><span class="c">!maximum resistance of soil/plant</span>
<a id="ln-176" name="ln-176" href="#ln-176"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">GRLAI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="w"> </span><span class="c">!Leave area index of green roof</span>
<a id="ln-177" name="ln-177" href="#ln-177"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">wsoil</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!water content of soil (kg/m3)</span>
<a id="ln-178" name="ln-178" href="#ln-178"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bldT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!building internal temperature, currently also ground temperature at a depth equal to floor facet thickness</span>
<a id="ln-179" name="ln-179" href="#ln-179"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">skyLW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!longwave radiation from the sky</span>
<a id="ln-180" name="ln-180" href="#ln-180"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">gres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!saturation vapour pressure of green roof</span>
<a id="ln-181" name="ln-181" href="#ln-181"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grqs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!saturation humidity of green roof</span>
<a id="ln-182" name="ln-182" href="#ln-182"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grdqdt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!gradient of saturation humidity for green roof</span>
<a id="ln-183" name="ln-183" href="#ln-183"></a>
<a id="ln-184" name="ln-184" href="#ln-184"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">numol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.5e-5</span><span class="w"> </span><span class="c">!&lt; kinematic viscosity for couette flow Re=5000 (Re=Uinf*H/(2*nu)) H=1, Uinf=1</span>
<a id="ln-185" name="ln-185" href="#ln-185"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">numoli</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">numol</span><span class="w"> </span><span class="c">!&lt; 1/numol</span>
<a id="ln-186" name="ln-186" href="#ln-186"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">prandtlmol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.71</span><span class="w"> </span><span class="c">!&lt; Prandtl number (for air at 300K). Fluid property!</span>
<a id="ln-187" name="ln-187" href="#ln-187"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">prandtlmoli</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">prandtlmol</span><span class="w"> </span><span class="c">!&lt; Inverse of Prandtl number</span>
<a id="ln-188" name="ln-188" href="#ln-188"></a>
<a id="ln-189" name="ln-189" href="#ln-189"></a><span class="w">   </span><span class="kt">integer</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">iwallmom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">iwalltemp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iwallmoist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iwallscal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-190" name="ln-190" href="#ln-190"></a>
<a id="ln-191" name="ln-191" href="#ln-191"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rhow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.998e3</span><span class="w"> </span><span class="c">!&lt;    * Density of water</span>
<a id="ln-192" name="ln-192" href="#ln-192"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pref0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.e5</span><span class="w"> </span><span class="c">!&lt;    *standard pressure used in exner function.</span>
<a id="ln-193" name="ln-193" href="#ln-193"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tmelt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">27</span><span class="mf">3.16</span><span class="w"> </span><span class="c">!&lt;    *temperature of melting of ice.</span>
<a id="ln-194" name="ln-194" href="#ln-194"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">es0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">61</span><span class="mf">0.78</span><span class="w"> </span><span class="c">!&lt;    * constants used for computation</span>
<a id="ln-195" name="ln-195" href="#ln-195"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="mf">7.27</span><span class="w"> </span><span class="c">!&lt;    * of saturation mixing ratio</span>
<a id="ln-196" name="ln-196" href="#ln-196"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">bt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="mf">5.86</span><span class="w"> </span><span class="c">!&lt;    * using Tetens Formula.</span>
<a id="ln-197" name="ln-197" href="#ln-197"></a><span class="w">   </span><span class="c">!      real,parameter :: ekmin    = 1.e-6            !&lt;    *minimum value for k-coefficient.</span>
<a id="ln-198" name="ln-198" href="#ln-198"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ekmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.e-12</span><span class="w"> </span><span class="c">!&lt;    *minimum value for k-coefficient.</span>
<a id="ln-199" name="ln-199" href="#ln-199"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">e12min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.e-5</span><span class="w"> </span><span class="c">!&lt;    *minimum value for TKE.</span>
<a id="ln-200" name="ln-200" href="#ln-200"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fkar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.41</span><span class="w"> </span><span class="c">!&lt;  0.41   *Von Karman constant</span>
<a id="ln-201" name="ln-201" href="#ln-201"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">eps1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.e-10</span><span class="w"> </span><span class="c">!&lt;    *very small number*</span>
<a id="ln-202" name="ln-202" href="#ln-202"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">epscloud</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.e-5</span><span class="w"> </span><span class="c">!&lt;    *limit for cloud calculation 0.01 g/kg</span>
<a id="ln-203" name="ln-203" href="#ln-203"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">boltz</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.67e-8</span><span class="w"> </span><span class="c">!&lt;    *Stefan-Boltzmann constant</span>
<a id="ln-204" name="ln-204" href="#ln-204"></a>
<a id="ln-205" name="ln-205" href="#ln-205"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lprofforc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  nudge flow to a profile !</span>
<a id="ln-206" name="ln-206" href="#ln-206"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lcoriol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch for coriolis force</span>
<a id="ln-207" name="ln-207" href="#ln-207"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">igrw_damp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="c">!&lt; switch to enable gravity wave damping</span>
<a id="ln-208" name="ln-208" href="#ln-208"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">geodamptime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">720</span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt; time scale for nudging to geowind in sponge layer, prevents oscillations</span>
<a id="ln-209" name="ln-209" href="#ln-209"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">uflowrate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="c">!&lt; fixed flow rate used for u-velocity correction</span>
<a id="ln-210" name="ln-210" href="#ln-210"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">vflowrate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="c">!&lt; fixed flow rate used for v-velocity correction</span>
<a id="ln-211" name="ln-211" href="#ln-211"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">Uinf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt; fixed U_inf (used in inlet generator), also in conjunction with ifixuinf</span>
<a id="ln-212" name="ln-212" href="#ln-212"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">Vinf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!fixed V_inf</span>
<a id="ln-213" name="ln-213" href="#ln-213"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">inletav</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt; averaging interval for inlet generator</span>
<a id="ln-214" name="ln-214" href="#ln-214"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">totinletav</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt; averaging interval for inlet generator (used in Running Average)</span>
<a id="ln-215" name="ln-215" href="#ln-215"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">om22</span><span class="w"> </span><span class="c">!&lt;    *2.*omega_earth*cos(lat)</span>
<a id="ln-216" name="ln-216" href="#ln-216"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">om23</span><span class="w"> </span><span class="c">!&lt;    *2.*omega_earth*sin(lat)</span>
<a id="ln-217" name="ln-217" href="#ln-217"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">om22_gs</span><span class="w"> </span><span class="c">!&lt;    *2.*omega_earth*cos(lat)</span>
<a id="ln-218" name="ln-218" href="#ln-218"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">om23_gs</span><span class="w"> </span><span class="c">!&lt;    *2.*omega_earth*sin(lat)</span>
<a id="ln-219" name="ln-219" href="#ln-219"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">xlat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="mf">2.</span><span class="w"> </span><span class="c">!&lt;    *latitude  in degrees.</span>
<a id="ln-220" name="ln-220" href="#ln-220"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">xlon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt;    *longitude in degrees.</span>
<a id="ln-221" name="ln-221" href="#ln-221"></a>
<a id="ln-222" name="ln-222" href="#ln-222"></a><span class="w">   </span><span class="c">!scalar source in fluid domain</span>
<a id="ln-223" name="ln-223" href="#ln-223"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xSa</span><span class="p">(:)</span><span class="w"></span>
<a id="ln-224" name="ln-224" href="#ln-224"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ySa</span><span class="p">(:)</span><span class="w"></span>
<a id="ln-225" name="ln-225" href="#ln-225"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zSa</span><span class="p">(:)</span><span class="w"></span>
<a id="ln-226" name="ln-226" href="#ln-226"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">xS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">yS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">zS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-227" name="ln-227" href="#ln-227"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">SS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-228" name="ln-228" href="#ln-228"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">sigS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-229" name="ln-229" href="#ln-229"></a>
<a id="ln-230" name="ln-230" href="#ln-230"></a><span class="w">  </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lnudge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">                   </span><span class="c">!&lt; switch for applying nudging at the top of the domain</span>
<a id="ln-231" name="ln-231" href="#ln-231"></a><span class="w">  </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tnudge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="mf">0.</span><span class="w">                       </span><span class="c">!&lt; time scale for nudging</span>
<a id="ln-232" name="ln-232" href="#ln-232"></a><span class="w">  </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nnudge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<a id="ln-233" name="ln-233" href="#ln-233"></a>
<a id="ln-234" name="ln-234" href="#ln-234"></a><span class="w">  </span><span class="c">!chemistry</span>
<a id="ln-235" name="ln-235" href="#ln-235"></a><span class="w">  </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lchem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">    </span><span class="c">! switch for basic chemistry</span>
<a id="ln-236" name="ln-236" href="#ln-236"></a><span class="w">  </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">k1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">,</span><span class="w"> </span><span class="n">JNO2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w">   </span><span class="c">! k1 = rate constant (O3 + NO -&gt; NO2 + 02 ), JNO2 = NO2 photolysis rate</span>
<a id="ln-237" name="ln-237" href="#ln-237"></a>
<a id="ln-238" name="ln-238" href="#ln-238"></a><span class="w">   </span><span class="c">! Poisson solver</span>
<a id="ln-239" name="ln-239" href="#ln-239"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">POISS_FFT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<a id="ln-240" name="ln-240" href="#ln-240"></a><span class="w">                         </span><span class="n">POISS_CYC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-241" name="ln-241" href="#ln-241"></a>
<a id="ln-242" name="ln-242" href="#ln-242"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ipoiss</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">POISS_CYC</span><span class="w"></span>
<a id="ln-243" name="ln-243" href="#ln-243"></a>
<a id="ln-244" name="ln-244" href="#ln-244"></a><span class="w">   </span><span class="c">!Advection scheme</span>
<a id="ln-245" name="ln-245" href="#ln-245"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iadv_upw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">  </span><span class="c">!&lt; first order upwind scheme</span>
<a id="ln-246" name="ln-246" href="#ln-246"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iadv_cd2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">  </span><span class="c">!&lt; second order central difference scheme</span>
<a id="ln-247" name="ln-247" href="#ln-247"></a><span class="w">   </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iadv_kappa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w">  </span><span class="c">!&lt; Kappa scheme</span>
<a id="ln-248" name="ln-248" href="#ln-248"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iadv_mom</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_tke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_thl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_qt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<a id="ln-249" name="ln-249" href="#ln-249"></a>
<a id="ln-250" name="ln-250" href="#ln-250"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lmoist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;   switch to calculate moisture fields</span>
<a id="ln-251" name="ln-251" href="#ln-251"></a><span class="w">   </span><span class="c">! Global variables (modvar.f90)</span>
<a id="ln-252" name="ln-252" href="#ln-252"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xday</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="w"> </span><span class="c">!&lt;     * day number</span>
<a id="ln-253" name="ln-253" href="#ln-253"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt;     * GMT time</span>
<a id="ln-254" name="ln-254" href="#ln-254"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">runtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt;     * simulation time in secs</span>
<a id="ln-255" name="ln-255" href="#ln-255"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dtmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt;     * maximum time integration interval</span>
<a id="ln-256" name="ln-256" href="#ln-256"></a>
<a id="ln-257" name="ln-257" href="#ln-257"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">trestart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt;     * each trestart sec. a restart file is written to disk. bss116: per default do not write restart files</span>
<a id="ln-258" name="ln-258" href="#ln-258"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tfielddump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt; Time step for field outputs</span>
<a id="ln-259" name="ln-259" href="#ln-259"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tsample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.</span><span class="w"> </span><span class="c">!&lt;    Sample time steps for statistics</span>
<a id="ln-260" name="ln-260" href="#ln-260"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tstatsdump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt; Time step for statistics outputs tg3315</span>
<a id="ln-261" name="ln-261" href="#ln-261"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tnextrestart</span><span class="w"> </span><span class="c">!&lt;     * each trestart sec. a restart file is written to disk</span>
<a id="ln-262" name="ln-262" href="#ln-262"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tscale</span><span class="w"> </span><span class="c">!       timescale: domain height*Uinf/utau**2</span>
<a id="ln-263" name="ln-263" href="#ln-263"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tnextfielddump</span><span class="w"> </span><span class="c">!&lt;</span>
<a id="ln-264" name="ln-264" href="#ln-264"></a><span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">startfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span><span class="c">!&lt;    * name of the restart file</span>
<a id="ln-265" name="ln-265" href="#ln-265"></a>
<a id="ln-266" name="ln-266" href="#ln-266"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">totavtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!&lt;    * the total time over which the values are averaged in meansXXX.XXX</span>
<a id="ln-267" name="ln-267" href="#ln-267"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dtEB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.</span><span class="w"> </span><span class="c">!time interval between calculations of facet energy balance</span>
<a id="ln-268" name="ln-268" href="#ln-268"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tEB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!time of last calculation of facet energy balance</span>
<a id="ln-269" name="ln-269" href="#ln-269"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tnextEB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="c">!time for next calculation of facet energy balance</span>
<a id="ln-270" name="ln-270" href="#ln-270"></a>
<a id="ln-271" name="ln-271" href="#ln-271"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">thres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.e-3</span><span class="w"> </span><span class="c">!&lt;     * threshold value for inversion height calculations</span>
<a id="ln-272" name="ln-272" href="#ln-272"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dqt</span><span class="w"> </span><span class="c">!&lt;     * applied gradient of qt at top of model</span>
<a id="ln-273" name="ln-273" href="#ln-273"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dtheta</span><span class="w"> </span><span class="c">!&lt;     * applied gradient of theta at top of model</span>
<a id="ln-274" name="ln-274" href="#ln-274"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dsv</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;     * applied gradient of sv(n) at top of model</span>
<a id="ln-275" name="ln-275" href="#ln-275"></a>
<a id="ln-276" name="ln-276" href="#ln-276"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">dt</span><span class="w"> </span><span class="c">!&lt;     * time integration interval</span>
<a id="ln-277" name="ln-277" href="#ln-277"></a><span class="w">   </span><span class="c">!      integer(kind=longint) :: timee             !&lt;     * elapsed time since the &quot;cold&quot; start</span>
<a id="ln-278" name="ln-278" href="#ln-278"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">timee</span><span class="w"> </span><span class="c">!&lt;     * elapsed time since the &quot;cold&quot; start</span>
<a id="ln-279" name="ln-279" href="#ln-279"></a><span class="w">   </span><span class="c">!      integer(kind=longint) :: btime             !&lt;     * time of (re)start</span>
<a id="ln-280" name="ln-280" href="#ln-280"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">btime</span><span class="w"> </span><span class="c">!&lt;     * time of (re)start</span>
<a id="ln-281" name="ln-281" href="#ln-281"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">runavtime</span><span class="w"> </span><span class="c">!&lt;     * time of starting running average</span>
<a id="ln-282" name="ln-282" href="#ln-282"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntimee</span><span class="w"> </span><span class="c">!&lt;     * number of timesteps since the cold start</span>
<a id="ln-283" name="ln-283" href="#ln-283"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ntrun</span><span class="w"> </span><span class="c">!&lt;     * number of timesteps since the start of the run</span>
<a id="ln-284" name="ln-284" href="#ln-284"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">timeleft</span><span class="w"></span>
<a id="ln-285" name="ln-285" href="#ln-285"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ladaptive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;    * adaptive timestepping on or off</span>
<a id="ln-286" name="ln-286" href="#ln-286"></a>
<a id="ln-287" name="ln-287" href="#ln-287"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tdriverstart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w">   </span><span class="c">!&lt;     * time at which to start recording inlet driver file (only necessary if idriver == 1)                                                                            </span>
<a id="ln-288" name="ln-288" href="#ln-288"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">tdriverdump</span><span class="w">         </span><span class="c">!&lt;     * time in inlet driver simulation at which data dumps are made (idriver == 1)</span>
<a id="ln-289" name="ln-289" href="#ln-289"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">dtdriver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="w">      </span><span class="c">!&lt;     * time frequency at which inlet driver data dumps are made (idriver == 1)</span>
<a id="ln-290" name="ln-290" href="#ln-290"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">driverstore</span><span class="w">         </span><span class="c">!&lt;     * number of stored driver steps for inlet (automatically calculated)</span>
<a id="ln-291" name="ln-291" href="#ln-291"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">driverjobnr</span><span class="w">         </span><span class="c">!&lt;     * Job number of the driver inlet generation run (idriver == 2)</span>
<a id="ln-292" name="ln-292" href="#ln-292"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lsdriver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w">   </span><span class="c">!&lt;     * switch for reading scalar driver files</span>
<a id="ln-293" name="ln-293" href="#ln-293"></a>
<a id="ln-294" name="ln-294" href="#ln-294"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">courant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="w"></span>
<a id="ln-295" name="ln-295" href="#ln-295"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">diffnr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="w"></span>
<a id="ln-296" name="ln-296" href="#ln-296"></a><span class="w">   </span><span class="kt">real</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">dt_lim</span><span class="w"></span>
<a id="ln-297" name="ln-297" href="#ln-297"></a>
<a id="ln-298" name="ln-298" href="#ln-298"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rk3step</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<a id="ln-299" name="ln-299" href="#ln-299"></a>
<a id="ln-300" name="ln-300" href="#ln-300"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">iexpnr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">!&lt;     * number of the experiment</span>
<a id="ln-301" name="ln-301" href="#ln-301"></a>
<a id="ln-302" name="ln-302" href="#ln-302"></a><span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">cexpnr</span><span class="w"></span>
<a id="ln-303" name="ln-303" href="#ln-303"></a>
<a id="ln-304" name="ln-304" href="#ln-304"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">thlsrc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<a id="ln-305" name="ln-305" href="#ln-305"></a>
<a id="ln-306" name="ln-306" href="#ln-306"></a><span class="w">   </span><span class="c">! modphsgrd.f90</span>
<a id="ln-307" name="ln-307" href="#ln-307"></a>
<a id="ln-308" name="ln-308" href="#ln-308"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dy</span><span class="w"> </span><span class="c">!&lt;  grid spacing in y-direction</span>
<a id="ln-309" name="ln-309" href="#ln-309"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dy2</span><span class="w"> </span><span class="c">!&lt;  grid spacing in y-direction squared</span>
<a id="ln-310" name="ln-310" href="#ln-310"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dz</span><span class="w"> </span><span class="c">!&lt;  grid spacing in z-direction</span>
<a id="ln-311" name="ln-311" href="#ln-311"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dyi</span><span class="w"> </span><span class="c">!&lt;  1/dy</span>
<a id="ln-312" name="ln-312" href="#ln-312"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dyiq</span><span class="w"> </span><span class="c">!&lt;  1/(dy*4)</span>
<a id="ln-313" name="ln-313" href="#ln-313"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dyi5</span><span class="w"> </span><span class="c">!&lt;  1/(dy*2)</span>
<a id="ln-314" name="ln-314" href="#ln-314"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dy2i</span><span class="w"> </span><span class="c">!&lt;  (1/dy)**2</span>
<a id="ln-315" name="ln-315" href="#ln-315"></a><span class="w">   </span>
<a id="ln-316" name="ln-316" href="#ln-316"></a><span class="w">   </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nwalllayers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<a id="ln-317" name="ln-317" href="#ln-317"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">AM</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">BM</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">CM</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">DM</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">EM</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">FM</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">GM</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">HM</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">inAM</span><span class="p">(:,:),</span><span class="n">IDM</span><span class="p">(:,:)</span><span class="w"> </span><span class="c">!matrices for the facet energy balance</span>
<a id="ln-318" name="ln-318" href="#ln-318"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">bb</span><span class="p">(:),</span><span class="n">w</span><span class="p">(:),</span><span class="n">dumv</span><span class="p">(:),</span><span class="n">Tdash</span><span class="p">(:)</span><span class="w"> </span><span class="c">!vector for the facet energy balance</span>
<a id="ln-319" name="ln-319" href="#ln-319"></a>
<a id="ln-320" name="ln-320" href="#ln-320"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rslabs</span><span class="w"></span>
<a id="ln-321" name="ln-321" href="#ln-321"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzf</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  thickness of full level</span>
<a id="ln-322" name="ln-322" href="#ln-322"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzfc</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  thickness of full level (extra ghost nodes (used in k-scheme)</span>
<a id="ln-323" name="ln-323" href="#ln-323"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzfci</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  1/dzfc</span>
<a id="ln-324" name="ln-324" href="#ln-324"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzf2</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  thickness of full level squared</span>
<a id="ln-325" name="ln-325" href="#ln-325"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzh</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  thickness of half level</span>
<a id="ln-326" name="ln-326" href="#ln-326"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zh</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  height of half level [m]</span>
<a id="ln-327" name="ln-327" href="#ln-327"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zf</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  height of full level [m]</span>
<a id="ln-328" name="ln-328" href="#ln-328"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzfi</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  1/dzf</span>
<a id="ln-329" name="ln-329" href="#ln-329"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzfiq</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  0.25*(1/dzf)</span>
<a id="ln-330" name="ln-330" href="#ln-330"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzfi5</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  0.5*(1/dzf)</span>
<a id="ln-331" name="ln-331" href="#ln-331"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzhi</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  1/dzh</span>
<a id="ln-332" name="ln-332" href="#ln-332"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzhci</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  1/dzh (extra ghost nodes (used in k-scheme)</span>
<a id="ln-333" name="ln-333" href="#ln-333"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzhiq</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  0.25*(1/dzh)</span>
<a id="ln-334" name="ln-334" href="#ln-334"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dzh2i</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  1/dzh^2</span>
<a id="ln-335" name="ln-335" href="#ln-335"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zhi</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  1/zh</span>
<a id="ln-336" name="ln-336" href="#ln-336"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zfi</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  1/zf</span>
<a id="ln-337" name="ln-337" href="#ln-337"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxf</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  thickness of full level</span>
<a id="ln-338" name="ln-338" href="#ln-338"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxfc</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  thickness of full level (extra ghost nodes (used in k-scheme)</span>
<a id="ln-339" name="ln-339" href="#ln-339"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxfci</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  1/dxfc</span>
<a id="ln-340" name="ln-340" href="#ln-340"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxf2</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  thickness of full level squared</span>
<a id="ln-341" name="ln-341" href="#ln-341"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxfi</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  = 1/dxf</span>
<a id="ln-342" name="ln-342" href="#ln-342"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxfiq</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  = 0.25*(1/dxf)</span>
<a id="ln-343" name="ln-343" href="#ln-343"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxfi5</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  = 0.5*(1/dxf)</span>
<a id="ln-344" name="ln-344" href="#ln-344"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxh</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  thickness of half level</span>
<a id="ln-345" name="ln-345" href="#ln-345"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxhi</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  = 1/dxh</span>
<a id="ln-346" name="ln-346" href="#ln-346"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxhci</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  = 1/dxh (with extra ghost nodes (used in k-scheme))</span>
<a id="ln-347" name="ln-347" href="#ln-347"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxhiq</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  = 0.25*(1/dxh)</span>
<a id="ln-348" name="ln-348" href="#ln-348"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dxh2i</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  = 1/dxh^2</span>
<a id="ln-349" name="ln-349" href="#ln-349"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xh</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  height of half level [m]</span>
<a id="ln-350" name="ln-350" href="#ln-350"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xf</span><span class="p">(:)</span><span class="w"> </span><span class="c">!&lt;  height of full level [m]</span>
<a id="ln-351" name="ln-351" href="#ln-351"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="w"> </span><span class="c">!&lt;  domain size in x-direction</span>
<a id="ln-352" name="ln-352" href="#ln-352"></a><span class="w">   </span><span class="kt">real</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ysize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.</span><span class="w"> </span><span class="c">!&lt;  domain size in y-direction</span>
<a id="ln-353" name="ln-353" href="#ln-353"></a><span class="w">   </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">delta</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="c">!&lt;  (dx*dy*dz)**(1/3)</span>
<a id="ln-354" name="ln-354" href="#ln-354"></a>
<a id="ln-355" name="ln-355" href="#ln-355"></a><span class="w">   </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lmomsubs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"> </span><span class="c">!&lt;  switch to apply subsidence on the momentum or not</span>
<a id="ln-356" name="ln-356" href="#ln-356"></a><span class="w">   </span><span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;DALES U&#39;</span><span class="w"></span>
<a id="ln-357" name="ln-357" href="#ln-357"></a><span class="k">contains</span><span class="w"></span>
<a id="ln-358" name="ln-358" href="#ln-358"></a>
<a id="ln-359" name="ln-359" href="#ln-359"></a><span class="w">   </span><span class="c">!&gt; Initialize global settings.</span>
<a id="ln-360" name="ln-360" href="#ln-360"></a><span class="w">   </span><span class="c">!!</span>
<a id="ln-361" name="ln-361" href="#ln-361"></a><span class="w">   </span><span class="c">!! Set courant number, calculate the grid sizes (both computational and physical), and set the coriolis parameter</span>
<a id="ln-362" name="ln-362" href="#ln-362"></a><span class="w">   </span><span class="k">subroutine </span><span class="n">initglobal</span><span class="w"></span>
<a id="ln-363" name="ln-363" href="#ln-363"></a><span class="w">      </span><span class="k">use </span><span class="n">modmpi</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="n">nprocs</span><span class="p">,</span><span class="w"> </span><span class="n">myid</span><span class="p">,</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">my_real</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="w"></span>
<a id="ln-364" name="ln-364" href="#ln-364"></a><span class="w">      </span><span class="k">implicit none</span>
<a id="ln-365" name="ln-365" href="#ln-365"></a>
<a id="ln-366" name="ln-366" href="#ln-366"></a><span class="k">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">advarr</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<a id="ln-367" name="ln-367" href="#ln-367"></a><span class="w">      </span><span class="kt">real </span><span class="n">phi</span><span class="p">,</span><span class="w"> </span><span class="n">colat</span><span class="p">,</span><span class="w"> </span><span class="n">silat</span><span class="p">,</span><span class="w"> </span><span class="n">omega</span><span class="p">,</span><span class="w"> </span><span class="n">omega_gs</span><span class="w"></span>
<a id="ln-368" name="ln-368" href="#ln-368"></a><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"></span>
<a id="ln-369" name="ln-369" href="#ln-369"></a><span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="n">chmess</span><span class="w"></span>
<a id="ln-370" name="ln-370" href="#ln-370"></a>
<a id="ln-371" name="ln-371" href="#ln-371"></a><span class="w">      </span><span class="c">!timestepping</span>
<a id="ln-372" name="ln-372" href="#ln-372"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">courant</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-373" name="ln-373" href="#ln-373"></a><span class="k">         select case</span><span class="w"> </span><span class="p">(</span><span class="n">iadv_mom</span><span class="p">)</span><span class="w"></span>
<a id="ln-374" name="ln-374" href="#ln-374"></a><span class="w">         </span><span class="k">case</span><span class="w"> </span><span class="p">(</span><span class="n">iadv_cd2</span><span class="p">)</span><span class="w"></span>
<a id="ln-375" name="ln-375" href="#ln-375"></a><span class="w">            </span><span class="n">courant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.5</span><span class="w"></span>
<a id="ln-376" name="ln-376" href="#ln-376"></a><span class="w">         </span><span class="k">case </span><span class="n">default</span><span class="w"></span>
<a id="ln-377" name="ln-377" href="#ln-377"></a><span class="w">            </span><span class="n">courant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.4</span><span class="w"></span>
<a id="ln-378" name="ln-378" href="#ln-378"></a><span class="w">         </span><span class="k">end select</span>
<a id="ln-379" name="ln-379" href="#ln-379"></a><span class="k">         if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_kappa</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">any</span><span class="p">((</span><span class="o">/</span><span class="n">iadv_thl</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_qt</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_tke</span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_kappa</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-380" name="ln-380" href="#ln-380"></a><span class="k">            </span><span class="n">courant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">courant</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1</span><span class="p">)</span><span class="w"></span>
<a id="ln-381" name="ln-381" href="#ln-381"></a><span class="w">         </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_upw</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">any</span><span class="p">((</span><span class="o">/</span><span class="n">iadv_thl</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_qt</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_tke</span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_upw</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-382" name="ln-382" href="#ln-382"></a><span class="k">            </span><span class="n">courant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">courant</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1</span><span class="p">)</span><span class="w"></span>
<a id="ln-383" name="ln-383" href="#ln-383"></a><span class="w">         </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_cd2</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">any</span><span class="p">((</span><span class="o">/</span><span class="n">iadv_thl</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_qt</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_tke</span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_cd2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-384" name="ln-384" href="#ln-384"></a><span class="k">            </span><span class="n">courant</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">min</span><span class="p">(</span><span class="n">courant</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5</span><span class="p">)</span><span class="w"></span>
<a id="ln-385" name="ln-385" href="#ln-385"></a><span class="w">         </span><span class="k">end if</span>
<a id="ln-386" name="ln-386" href="#ln-386"></a><span class="k">      end if</span><span class="w"></span>
<a id="ln-387" name="ln-387" href="#ln-387"></a>
<a id="ln-388" name="ln-388" href="#ln-388"></a><span class="w">      </span><span class="c">! phsgrid</span>
<a id="ln-389" name="ln-389" href="#ln-389"></a>
<a id="ln-390" name="ln-390" href="#ln-390"></a><span class="w">      </span><span class="n">jmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot</span><span class="o">/</span><span class="n">nprocs</span><span class="w"></span>
<a id="ln-391" name="ln-391" href="#ln-391"></a><span class="w">      </span><span class="n">isen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">imax</span><span class="o">/</span><span class="n">nprocs</span><span class="w"></span>
<a id="ln-392" name="ln-392" href="#ln-392"></a><span class="w">      </span><span class="n">jsen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jmax</span><span class="w"></span>
<a id="ln-393" name="ln-393" href="#ln-393"></a><span class="w">      </span><span class="c">!set the number of ghost cells. NB: This switch has to run in order of required ghost cells</span>
<a id="ln-394" name="ln-394" href="#ln-394"></a><span class="w">      </span><span class="n">advarr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="n">iadv_mom</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_tke</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_thl</span><span class="p">,</span><span class="w"> </span><span class="n">iadv_qt</span><span class="o">/</span><span class="p">)</span><span class="w"></span>
<a id="ln-395" name="ln-395" href="#ln-395"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">advarr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_kappa</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-396" name="ln-396" href="#ln-396"></a><span class="k">         </span><span class="n">ih</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-397" name="ln-397" href="#ln-397"></a><span class="w">         </span><span class="n">jh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-398" name="ln-398" href="#ln-398"></a><span class="w">         </span><span class="c">! ih = 1</span>
<a id="ln-399" name="ln-399" href="#ln-399"></a><span class="w">         </span><span class="c">! jh = 1</span>
<a id="ln-400" name="ln-400" href="#ln-400"></a><span class="w">         </span><span class="n">kh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-401" name="ln-401" href="#ln-401"></a><span class="w">      </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">advarr</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_cd2</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_cd2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-402" name="ln-402" href="#ln-402"></a><span class="k">         </span><span class="n">ih</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-403" name="ln-403" href="#ln-403"></a><span class="w">         </span><span class="n">jh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-404" name="ln-404" href="#ln-404"></a><span class="w">         </span><span class="n">kh</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-405" name="ln-405" href="#ln-405"></a><span class="w">         </span><span class="n">ihc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-406" name="ln-406" href="#ln-406"></a><span class="w">         </span><span class="n">jhc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-407" name="ln-407" href="#ln-407"></a><span class="w">         </span><span class="n">khc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-408" name="ln-408" href="#ln-408"></a><span class="w">      </span><span class="k">end if</span><span class="w"></span>
<a id="ln-409" name="ln-409" href="#ln-409"></a>
<a id="ln-410" name="ln-410" href="#ln-410"></a><span class="w">      </span><span class="c">! J. Tomas added this for using only kappa scheme for sv(:)</span>
<a id="ln-411" name="ln-411" href="#ln-411"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_kappa</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-412" name="ln-412" href="#ln-412"></a><span class="k">         </span><span class="n">ihc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-413" name="ln-413" href="#ln-413"></a><span class="w">         </span><span class="n">jhc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-414" name="ln-414" href="#ln-414"></a><span class="w">         </span><span class="n">khc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<a id="ln-415" name="ln-415" href="#ln-415"></a><span class="w">      </span><span class="k">end if</span>
<a id="ln-416" name="ln-416" href="#ln-416"></a>
<a id="ln-417" name="ln-417" href="#ln-417"></a><span class="k">      </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<a id="ln-418" name="ln-418" href="#ln-418"></a><span class="w">      </span><span class="n">ib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="w"></span>
<a id="ln-419" name="ln-419" href="#ln-419"></a><span class="w">      </span><span class="n">ie</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">imax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="w"></span>
<a id="ln-420" name="ln-420" href="#ln-420"></a><span class="w">      </span><span class="n">jb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="w"></span>
<a id="ln-421" name="ln-421" href="#ln-421"></a><span class="w">      </span><span class="n">je</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jmax</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="w"></span>
<a id="ln-422" name="ln-422" href="#ln-422"></a><span class="w">      </span><span class="n">jgb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jb</span><span class="w"> </span><span class="c">! global j range (starting at the same as j as the processor j range)</span>
<a id="ln-423" name="ln-423" href="#ln-423"></a><span class="w">      </span><span class="n">jge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jtot</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="c">! global j range</span>
<a id="ln-424" name="ln-424" href="#ln-424"></a><span class="w">      </span><span class="n">kb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="w"></span>
<a id="ln-425" name="ln-425" href="#ln-425"></a><span class="w">      </span><span class="n">ke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kmax</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">offset</span><span class="w"></span>
<a id="ln-426" name="ln-426" href="#ln-426"></a>
<a id="ln-427" name="ln-427" href="#ln-427"></a><span class="w">      </span><span class="c">! Global constants</span>
<a id="ln-428" name="ln-428" href="#ln-428"></a>
<a id="ln-429" name="ln-429" href="#ln-429"></a><span class="w">      </span><span class="c">! Select advection scheme for scalars. If not set in the options file, the momentum scheme is used</span>
<a id="ln-430" name="ln-430" href="#ln-430"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iadv_tke</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">iadv_tke</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iadv_mom</span><span class="w"></span>
<a id="ln-431" name="ln-431" href="#ln-431"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iadv_thl</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">iadv_thl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iadv_mom</span><span class="w"></span>
<a id="ln-432" name="ln-432" href="#ln-432"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iadv_qt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">iadv_qt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iadv_mom</span><span class="w"></span>
<a id="ln-433" name="ln-433" href="#ln-433"></a>
<a id="ln-434" name="ln-434" href="#ln-434"></a><span class="w">      </span><span class="c">!CvH remove where</span>
<a id="ln-435" name="ln-435" href="#ln-435"></a><span class="w">      </span><span class="c">!where (iadv_sv&lt;0)  iadv_sv  = iadv_mom</span>
<a id="ln-436" name="ln-436" href="#ln-436"></a>
<a id="ln-437" name="ln-437" href="#ln-437"></a><span class="w">      </span><span class="c">!tg3315 added - only uses kappa advection scheme...</span>
<a id="ln-438" name="ln-438" href="#ln-438"></a><span class="w">      </span><span class="k">do </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nsv</span><span class="w"></span>
<a id="ln-439" name="ln-439" href="#ln-439"></a><span class="w">         </span><span class="n">iadv_sv</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iadv_kappa</span><span class="w"></span>
<a id="ln-440" name="ln-440" href="#ln-440"></a><span class="w">      </span><span class="k">end do</span><span class="w"></span>
<a id="ln-441" name="ln-441" href="#ln-441"></a><span class="w">      </span><span class="c">!ends here</span>
<a id="ln-442" name="ln-442" href="#ln-442"></a>
<a id="ln-443" name="ln-443" href="#ln-443"></a><span class="w">      </span><span class="n">phi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xlat</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="mf">0.</span><span class="w"></span>
<a id="ln-444" name="ln-444" href="#ln-444"></a><span class="w">      </span><span class="n">colat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>
<a id="ln-445" name="ln-445" href="#ln-445"></a><span class="w">      </span><span class="n">silat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="w"></span>
<a id="ln-446" name="ln-446" href="#ln-446"></a>
<a id="ln-447" name="ln-447" href="#ln-447"></a><span class="w">      </span><span class="n">omega</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.292e-5</span><span class="w"></span>
<a id="ln-448" name="ln-448" href="#ln-448"></a><span class="w">      </span><span class="n">omega_gs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">7.292e-5</span><span class="w"></span>
<a id="ln-449" name="ln-449" href="#ln-449"></a><span class="w">      </span><span class="n">om22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">colat</span><span class="w"></span>
<a id="ln-450" name="ln-450" href="#ln-450"></a><span class="w">      </span><span class="n">om23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">silat</span><span class="w"></span>
<a id="ln-451" name="ln-451" href="#ln-451"></a><span class="w">      </span><span class="n">om22_gs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="o">*</span><span class="n">omega_gs</span><span class="o">*</span><span class="n">colat</span><span class="w"></span>
<a id="ln-452" name="ln-452" href="#ln-452"></a><span class="w">      </span><span class="n">om23_gs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.</span><span class="o">*</span><span class="n">omega_gs</span><span class="o">*</span><span class="n">silat</span><span class="w"></span>
<a id="ln-453" name="ln-453" href="#ln-453"></a>
<a id="ln-454" name="ln-454" href="#ln-454"></a><span class="w">      </span><span class="c">! Variables</span>
<a id="ln-455" name="ln-455" href="#ln-455"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dsv</span><span class="p">(</span><span class="n">nsv</span><span class="p">))</span><span class="w"></span>
<a id="ln-456" name="ln-456" href="#ln-456"></a><span class="w">      </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="n">cexpnr</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(i3.3)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">iexpnr</span><span class="w"></span>
<a id="ln-457" name="ln-457" href="#ln-457"></a>
<a id="ln-458" name="ln-458" href="#ln-458"></a><span class="w">      </span><span class="c">! Create the physical grid variables</span>
<a id="ln-459" name="ln-459" href="#ln-459"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-460" name="ln-460" href="#ln-460"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzf2</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-461" name="ln-461" href="#ln-461"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzfi</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-462" name="ln-462" href="#ln-462"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzfiq</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-463" name="ln-463" href="#ln-463"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzfi5</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-464" name="ln-464" href="#ln-464"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-465" name="ln-465" href="#ln-465"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzhi</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-466" name="ln-466" href="#ln-466"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzhiq</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-467" name="ln-467" href="#ln-467"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzh2i</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-468" name="ln-468" href="#ln-468"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-469" name="ln-469" href="#ln-469"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">zf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-470" name="ln-470" href="#ln-470"></a>
<a id="ln-471" name="ln-471" href="#ln-471"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxf</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-472" name="ln-472" href="#ln-472"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxf2</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-473" name="ln-473" href="#ln-473"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxfi</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-474" name="ln-474" href="#ln-474"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxfiq</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-475" name="ln-475" href="#ln-475"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxfi5</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-476" name="ln-476" href="#ln-476"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxh</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-477" name="ln-477" href="#ln-477"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxhi</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-478" name="ln-478" href="#ln-478"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxhiq</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-479" name="ln-479" href="#ln-479"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxh2i</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-480" name="ln-480" href="#ln-480"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">xh</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-481" name="ln-481" href="#ln-481"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">xf</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">))</span><span class="w"></span>
<a id="ln-482" name="ln-482" href="#ln-482"></a><span class="w">      </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">delta</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">,</span><span class="w"> </span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">))</span><span class="w"></span>
<a id="ln-483" name="ln-483" href="#ln-483"></a>
<a id="ln-484" name="ln-484" href="#ln-484"></a><span class="w">      </span><span class="n">rslabs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">imax</span><span class="o">*</span><span class="n">jtot</span><span class="p">)</span><span class="w"></span>
<a id="ln-485" name="ln-485" href="#ln-485"></a>
<a id="ln-486" name="ln-486" href="#ln-486"></a><span class="w">      </span><span class="n">dy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ysize</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">jtot</span><span class="p">)</span><span class="w"></span>
<a id="ln-487" name="ln-487" href="#ln-487"></a>
<a id="ln-488" name="ln-488" href="#ln-488"></a><span class="w">      </span><span class="c">! MPI</span>
<a id="ln-489" name="ln-489" href="#ln-489"></a>
<a id="ln-490" name="ln-490" href="#ln-490"></a><span class="w">      </span><span class="c">! Note, that the loop for reading zf and calculating zh</span>
<a id="ln-491" name="ln-491" href="#ln-491"></a><span class="w">      </span><span class="c">! has been split so that reading is only done on PE 1</span>
<a id="ln-492" name="ln-492" href="#ln-492"></a>
<a id="ln-493" name="ln-493" href="#ln-493"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">myid</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-494" name="ln-494" href="#ln-494"></a><span class="k">         open</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;prof.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span><span class="w"></span>
<a id="ln-495" name="ln-495" href="#ln-495"></a><span class="w">         </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a72)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">chmess</span><span class="w"></span>
<a id="ln-496" name="ln-496" href="#ln-496"></a><span class="w">         </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a72)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">chmess</span><span class="w"></span>
<a id="ln-497" name="ln-497" href="#ln-497"></a>
<a id="ln-498" name="ln-498" href="#ln-498"></a><span class="w">         </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kb</span><span class="p">,</span><span class="w"> </span><span class="n">ke</span><span class="w"></span>
<a id="ln-499" name="ln-499" href="#ln-499"></a><span class="w">            </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-500" name="ln-500" href="#ln-500"></a><span class="w">         </span><span class="k">end do</span>
<a id="ln-501" name="ln-501" href="#ln-501"></a><span class="k">         close</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">)</span><span class="w"></span>
<a id="ln-502" name="ln-502" href="#ln-502"></a>
<a id="ln-503" name="ln-503" href="#ln-503"></a><span class="w">         </span><span class="c">! J. Tomas: Read the x-coordinates of the cell centers from xgrid.inp.XXX</span>
<a id="ln-504" name="ln-504" href="#ln-504"></a><span class="w">         </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="s1">&#39;xgrid.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span><span class="w"></span>
<a id="ln-505" name="ln-505" href="#ln-505"></a><span class="w">         </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a72)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">chmess</span><span class="w"></span>
<a id="ln-506" name="ln-506" href="#ln-506"></a><span class="w">         </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a72)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">chmess</span><span class="w"></span>
<a id="ln-507" name="ln-507" href="#ln-507"></a>
<a id="ln-508" name="ln-508" href="#ln-508"></a><span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="w"></span>
<a id="ln-509" name="ln-509" href="#ln-509"></a><span class="w">            </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<a id="ln-510" name="ln-510" href="#ln-510"></a><span class="w">         </span><span class="k">end do</span>
<a id="ln-511" name="ln-511" href="#ln-511"></a><span class="k">         close</span><span class="w"> </span><span class="p">(</span><span class="n">ifinput</span><span class="p">)</span><span class="w"></span>
<a id="ln-512" name="ln-512" href="#ln-512"></a>
<a id="ln-513" name="ln-513" href="#ln-513"></a><span class="w">      </span><span class="k">end if</span><span class="w"> </span><span class="c">! end if myid==0</span>
<a id="ln-514" name="ln-514" href="#ln-514"></a>
<a id="ln-515" name="ln-515" href="#ln-515"></a><span class="w">      </span><span class="c">! MPI broadcast kmax elements from zf</span>
<a id="ln-516" name="ln-516" href="#ln-516"></a><span class="w">      </span><span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span><span class="w"> </span><span class="n">kmax</span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-517" name="ln-517" href="#ln-517"></a><span class="w">      </span><span class="c">! MPI broadcast imax elements from xf</span>
<a id="ln-518" name="ln-518" href="#ln-518"></a><span class="w">      </span><span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span><span class="w"> </span><span class="n">imax</span><span class="p">,</span><span class="w"> </span><span class="n">MY_REAL</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">comm3d</span><span class="p">,</span><span class="w"> </span><span class="n">mpierr</span><span class="p">)</span><span class="w"></span>
<a id="ln-519" name="ln-519" href="#ln-519"></a>
<a id="ln-520" name="ln-520" href="#ln-520"></a><span class="w">      </span><span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-521" name="ln-521" href="#ln-521"></a><span class="w">      </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kb</span><span class="p">,</span><span class="w"> </span><span class="n">ke</span><span class="w"></span>
<a id="ln-522" name="ln-522" href="#ln-522"></a><span class="w">         </span><span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<a id="ln-523" name="ln-523" href="#ln-523"></a><span class="w">      </span><span class="k">end do</span>
<a id="ln-524" name="ln-524" href="#ln-524"></a><span class="k">      </span><span class="n">zf</span><span class="p">(</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zf</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">zf</span><span class="p">(</span><span class="n">ke</span><span class="p">))</span><span class="w"></span>
<a id="ln-525" name="ln-525" href="#ln-525"></a>
<a id="ln-526" name="ln-526" href="#ln-526"></a><span class="w">      </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kb</span><span class="p">,</span><span class="w"> </span><span class="n">ke</span><span class="w"></span>
<a id="ln-527" name="ln-527" href="#ln-527"></a><span class="w">         </span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-528" name="ln-528" href="#ln-528"></a><span class="w">      </span><span class="k">end do</span>
<a id="ln-529" name="ln-529" href="#ln-529"></a><span class="k">      </span><span class="n">dzf</span><span class="p">(</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzf</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span><span class="w"></span>
<a id="ln-530" name="ln-530" href="#ln-530"></a><span class="w">      </span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="w"></span>
<a id="ln-531" name="ln-531" href="#ln-531"></a>
<a id="ln-532" name="ln-532" href="#ln-532"></a><span class="w">      </span><span class="n">dzh</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">zf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="w"></span>
<a id="ln-533" name="ln-533" href="#ln-533"></a><span class="w">      </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kb</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="w"></span>
<a id="ln-534" name="ln-534" href="#ln-534"></a><span class="w">         </span><span class="n">dzh</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-535" name="ln-535" href="#ln-535"></a><span class="w">      </span><span class="k">end do</span><span class="w"></span>
<a id="ln-536" name="ln-536" href="#ln-536"></a>
<a id="ln-537" name="ln-537" href="#ln-537"></a><span class="w">      </span><span class="c">! j. tomas: same trick for x-direction...</span>
<a id="ln-538" name="ln-538" href="#ln-538"></a><span class="w">      </span><span class="n">xh</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<a id="ln-539" name="ln-539" href="#ln-539"></a><span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="w"></span>
<a id="ln-540" name="ln-540" href="#ln-540"></a><span class="w">         </span><span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="w"></span>
<a id="ln-541" name="ln-541" href="#ln-541"></a><span class="w">      </span><span class="k">end do</span>
<a id="ln-542" name="ln-542" href="#ln-542"></a><span class="k">      </span><span class="n">xf</span><span class="p">(</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xf</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">xh</span><span class="p">(</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xf</span><span class="p">(</span><span class="n">ie</span><span class="p">))</span><span class="w"></span>
<a id="ln-543" name="ln-543" href="#ln-543"></a>
<a id="ln-544" name="ln-544" href="#ln-544"></a><span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="w"></span>
<a id="ln-545" name="ln-545" href="#ln-545"></a><span class="w">         </span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<a id="ln-546" name="ln-546" href="#ln-546"></a><span class="w">      </span><span class="k">end do</span>
<a id="ln-547" name="ln-547" href="#ln-547"></a><span class="k">      </span><span class="n">dxf</span><span class="p">(</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxf</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span><span class="w"></span>
<a id="ln-548" name="ln-548" href="#ln-548"></a><span class="w">      </span><span class="n">dxf</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxf</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span><span class="w"></span>
<a id="ln-549" name="ln-549" href="#ln-549"></a>
<a id="ln-550" name="ln-550" href="#ln-550"></a><span class="w">      </span><span class="n">dxh</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">xf</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span><span class="w"></span>
<a id="ln-551" name="ln-551" href="#ln-551"></a><span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="w"></span>
<a id="ln-552" name="ln-552" href="#ln-552"></a><span class="w">         </span><span class="n">dxh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<a id="ln-553" name="ln-553" href="#ln-553"></a><span class="w">      </span><span class="k">end do</span>
<a id="ln-554" name="ln-554" href="#ln-554"></a>
<a id="ln-555" name="ln-555" href="#ln-555"></a><span class="k">      do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">kb</span><span class="p">,</span><span class="w"> </span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="w"></span>
<a id="ln-556" name="ln-556" href="#ln-556"></a><span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">,</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="w"></span>
<a id="ln-557" name="ln-557" href="#ln-557"></a><span class="w">            </span><span class="n">delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="w"></span>
<a id="ln-558" name="ln-558" href="#ln-558"></a><span class="w">         </span><span class="k">end do</span>
<a id="ln-559" name="ln-559" href="#ln-559"></a><span class="k">      end do</span><span class="w"></span>
<a id="ln-560" name="ln-560" href="#ln-560"></a>
<a id="ln-561" name="ln-561" href="#ln-561"></a><span class="w">      </span><span class="c">!--------------------------------------------------</span>
<a id="ln-562" name="ln-562" href="#ln-562"></a><span class="w">      </span><span class="c">! *** Check whether the grid is equidistant *****</span>
<a id="ln-563" name="ln-563" href="#ln-563"></a><span class="w">      </span><span class="c">!--------------------------------------------------</span>
<a id="ln-564" name="ln-564" href="#ln-564"></a><span class="w">      </span>
<a id="ln-565" name="ln-565" href="#ln-565"></a><span class="w">      </span><span class="c">!if (myid == 0) then</span>
<a id="ln-566" name="ln-566" href="#ln-566"></a><span class="w">      </span><span class="c">!do k=kb,ke+kh</span>
<a id="ln-567" name="ln-567" href="#ln-567"></a><span class="w">      </span><span class="c">!if (.not.(dzf(k).eq.dzf(1)))</span>
<a id="ln-568" name="ln-568" href="#ln-568"></a><span class="w">      </span><span class="c">!      write (6, *) &amp;</span>
<a id="ln-569" name="ln-569" href="#ln-569"></a><span class="w">      </span><span class="c">!      &#39;WARNING, You are working with a non-equidistant grid!!!!&#39;</span>
<a id="ln-570" name="ln-570" href="#ln-570"></a><span class="w">      </span><span class="c">!end if</span>
<a id="ln-571" name="ln-571" href="#ln-571"></a><span class="w">      </span><span class="c">!end do</span>
<a id="ln-572" name="ln-572" href="#ln-572"></a><span class="w">      </span><span class="c">!end if ! end if myid==0</span>
<a id="ln-573" name="ln-573" href="#ln-573"></a>
<a id="ln-574" name="ln-574" href="#ln-574"></a><span class="w">      </span><span class="n">dzhi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">dzh</span><span class="w"></span>
<a id="ln-575" name="ln-575" href="#ln-575"></a><span class="w">      </span><span class="n">dzfi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">dzf</span><span class="w"></span>
<a id="ln-576" name="ln-576" href="#ln-576"></a><span class="w">      </span><span class="n">dzf2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzf</span><span class="o">*</span><span class="n">dzf</span><span class="w"></span>
<a id="ln-577" name="ln-577" href="#ln-577"></a><span class="w">      </span><span class="n">dxhi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">dxh</span><span class="w"></span>
<a id="ln-578" name="ln-578" href="#ln-578"></a><span class="w">      </span><span class="n">dxfi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">dxf</span><span class="w"></span>
<a id="ln-579" name="ln-579" href="#ln-579"></a><span class="w">      </span><span class="n">dxf2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxf</span><span class="o">*</span><span class="n">dxf</span><span class="w"></span>
<a id="ln-580" name="ln-580" href="#ln-580"></a><span class="w">      </span><span class="n">dyi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">dy</span><span class="w"></span>
<a id="ln-581" name="ln-581" href="#ln-581"></a><span class="w">      </span><span class="n">dy2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dy</span><span class="o">*</span><span class="n">dy</span><span class="w"></span>
<a id="ln-582" name="ln-582" href="#ln-582"></a>
<a id="ln-583" name="ln-583" href="#ln-583"></a><span class="w">      </span><span class="n">dzhiq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="n">dzhi</span><span class="w"></span>
<a id="ln-584" name="ln-584" href="#ln-584"></a><span class="w">      </span><span class="n">dzfiq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="n">dzfi</span><span class="w"></span>
<a id="ln-585" name="ln-585" href="#ln-585"></a><span class="w">      </span><span class="n">dxhiq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="n">dxhi</span><span class="w"></span>
<a id="ln-586" name="ln-586" href="#ln-586"></a><span class="w">      </span><span class="n">dxfiq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="n">dxfi</span><span class="w"></span>
<a id="ln-587" name="ln-587" href="#ln-587"></a><span class="w">      </span><span class="n">dyiq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.25</span><span class="o">*</span><span class="n">dyi</span><span class="w"></span>
<a id="ln-588" name="ln-588" href="#ln-588"></a>
<a id="ln-589" name="ln-589" href="#ln-589"></a><span class="w">      </span><span class="n">dzh2i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzhi</span><span class="o">*</span><span class="n">dzhi</span><span class="w"></span>
<a id="ln-590" name="ln-590" href="#ln-590"></a><span class="w">      </span><span class="n">dxh2i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxhi</span><span class="o">*</span><span class="n">dxhi</span><span class="w"></span>
<a id="ln-591" name="ln-591" href="#ln-591"></a><span class="w">      </span><span class="n">dy2i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dyi</span><span class="o">*</span><span class="n">dyi</span><span class="w"></span>
<a id="ln-592" name="ln-592" href="#ln-592"></a>
<a id="ln-593" name="ln-593" href="#ln-593"></a><span class="w">      </span><span class="n">dzfi5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">dzfi</span><span class="w"></span>
<a id="ln-594" name="ln-594" href="#ln-594"></a><span class="w">      </span><span class="n">dxfi5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">dxfi</span><span class="w"></span>
<a id="ln-595" name="ln-595" href="#ln-595"></a><span class="w">      </span><span class="n">dyi5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="o">*</span><span class="n">dyi</span><span class="w"></span>
<a id="ln-596" name="ln-596" href="#ln-596"></a>
<a id="ln-597" name="ln-597" href="#ln-597"></a><span class="w">      </span><span class="c">! Grid used in kappa scheme advection (extra ghost nodes)</span>
<a id="ln-598" name="ln-598" href="#ln-598"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iadv_kappa</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<a id="ln-599" name="ln-599" href="#ln-599"></a><span class="k">         allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">khc</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">khc</span><span class="p">))</span><span class="w"></span>
<a id="ln-600" name="ln-600" href="#ln-600"></a><span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ihc</span><span class="p">))</span><span class="w"></span>
<a id="ln-601" name="ln-601" href="#ln-601"></a><span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzfci</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">khc</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">khc</span><span class="p">))</span><span class="w"></span>
<a id="ln-602" name="ln-602" href="#ln-602"></a><span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxfci</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ihc</span><span class="p">))</span><span class="w"></span>
<a id="ln-603" name="ln-603" href="#ln-603"></a><span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">khc</span><span class="p">))</span><span class="w"></span>
<a id="ln-604" name="ln-604" href="#ln-604"></a><span class="w">         </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ihc</span><span class="p">))</span><span class="w"></span>
<a id="ln-605" name="ln-605" href="#ln-605"></a>
<a id="ln-606" name="ln-606" href="#ln-606"></a><span class="w">         </span><span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-607" name="ln-607" href="#ln-607"></a><span class="w">         </span><span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">khc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-608" name="ln-608" href="#ln-608"></a><span class="w">         </span><span class="n">dzfc</span><span class="p">(</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">khc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzfc</span><span class="p">(</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-609" name="ln-609" href="#ln-609"></a>
<a id="ln-610" name="ln-610" href="#ln-610"></a><span class="w">         </span><span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxf</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">)</span><span class="w"></span>
<a id="ln-611" name="ln-611" href="#ln-611"></a><span class="w">         </span><span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ihc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ih</span><span class="p">)</span><span class="w"></span>
<a id="ln-612" name="ln-612" href="#ln-612"></a><span class="w">         </span><span class="n">dxfc</span><span class="p">(</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ihc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxfc</span><span class="p">(</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">)</span><span class="w"></span>
<a id="ln-613" name="ln-613" href="#ln-613"></a>
<a id="ln-614" name="ln-614" href="#ln-614"></a><span class="w">         </span><span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzhi</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-615" name="ln-615" href="#ln-615"></a><span class="w">         </span><span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="w"></span>
<a id="ln-616" name="ln-616" href="#ln-616"></a><span class="w">         </span><span class="n">dzhci</span><span class="p">(</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">khc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dzhci</span><span class="p">(</span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">kh</span><span class="p">)</span><span class="w"></span>
<a id="ln-617" name="ln-617" href="#ln-617"></a>
<a id="ln-618" name="ln-618" href="#ln-618"></a><span class="w">         </span><span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxhi</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">)</span><span class="w"></span>
<a id="ln-619" name="ln-619" href="#ln-619"></a><span class="w">         </span><span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span><span class="w"></span>
<a id="ln-620" name="ln-620" href="#ln-620"></a><span class="w">         </span><span class="n">dxhci</span><span class="p">(</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ihc</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dxhci</span><span class="p">(</span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ih</span><span class="p">)</span><span class="w"></span>
<a id="ln-621" name="ln-621" href="#ln-621"></a>
<a id="ln-622" name="ln-622" href="#ln-622"></a><span class="w">         </span><span class="n">dzfci</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">dzfc</span><span class="w"></span>
<a id="ln-623" name="ln-623" href="#ln-623"></a><span class="w">         </span><span class="n">dxfci</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.</span><span class="o">/</span><span class="n">dxfc</span><span class="w"></span>
<a id="ln-624" name="ln-624" href="#ln-624"></a><span class="w">      </span><span class="k">end if</span>
<a id="ln-625" name="ln-625" href="#ln-625"></a>
<a id="ln-626" name="ln-626" href="#ln-626"></a><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">myid</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<a id="ln-627" name="ln-627" href="#ln-627"></a>
<a id="ln-628" name="ln-628" href="#ln-628"></a><span class="k">         write</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;lev    dz     zf      zh       dzh    delta(ib,k)&#39;</span><span class="w"></span>
<a id="ln-629" name="ln-629" href="#ln-629"></a><span class="w">         </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ke</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">kb</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<a id="ln-630" name="ln-630" href="#ln-630"></a><span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(i4,5f8.5)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">dzh</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="w"> </span><span class="n">delta</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<a id="ln-631" name="ln-631" href="#ln-631"></a><span class="w">         </span><span class="k">end do</span><span class="w"></span>
<a id="ln-632" name="ln-632" href="#ln-632"></a><span class="w">         </span><span class="c">! same for x:</span>
<a id="ln-633" name="ln-633" href="#ln-633"></a><span class="w">         </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;lev    dxf     xf      xh       dxh    delta(i,kb)&#39;</span><span class="w"></span>
<a id="ln-634" name="ln-634" href="#ln-634"></a><span class="w">         </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ie</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ib</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<a id="ln-635" name="ln-635" href="#ln-635"></a><span class="w">            </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(i4,5f9.5)&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">dxh</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">kb</span><span class="p">)</span><span class="w"></span>
<a id="ln-636" name="ln-636" href="#ln-636"></a><span class="w">         </span><span class="k">end do</span>
<a id="ln-637" name="ln-637" href="#ln-637"></a><span class="k">      end if</span>
<a id="ln-638" name="ln-638" href="#ln-638"></a><span class="k">      </span><span class="n">tnextrestart</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trestart</span><span class="w"></span>
<a id="ln-639" name="ln-639" href="#ln-639"></a><span class="w">      </span><span class="n">tnextfielddump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tfielddump</span><span class="w"></span>
<a id="ln-640" name="ln-640" href="#ln-640"></a><span class="c">!    tnextstatsdump = tstatsdump</span>
<a id="ln-641" name="ln-641" href="#ln-641"></a><span class="w">      </span><span class="n">timeleft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">runtime</span><span class="w"> </span><span class="c">! tg3315 previously btime + runtime</span>
<a id="ln-642" name="ln-642" href="#ln-642"></a>
<a id="ln-643" name="ln-643" href="#ln-643"></a><span class="w">   </span><span class="k">end subroutine </span><span class="n">initglobal</span><span class="w"></span>
<a id="ln-644" name="ln-644" href="#ln-644"></a>
<a id="ln-645" name="ln-645" href="#ln-645"></a><span class="w">   </span><span class="c">!&gt; Clean up when leaving the run</span>
<a id="ln-646" name="ln-646" href="#ln-646"></a><span class="w">   </span><span class="k">subroutine </span><span class="n">exitglobal</span><span class="w"></span>
<a id="ln-647" name="ln-647" href="#ln-647"></a><span class="w">      </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">dsv</span><span class="p">,</span><span class="w"> </span><span class="n">dzf</span><span class="p">,</span><span class="w"> </span><span class="n">dzh</span><span class="p">,</span><span class="w"> </span><span class="n">zh</span><span class="p">,</span><span class="w"> </span><span class="n">zf</span><span class="p">,</span><span class="w"> </span><span class="n">delta</span><span class="p">)</span><span class="w"></span>
<a id="ln-648" name="ln-648" href="#ln-648"></a><span class="w">   </span><span class="k">end subroutine </span><span class="n">exitglobal</span><span class="w"></span>
<a id="ln-649" name="ln-649" href="#ln-649"></a>
<a id="ln-650" name="ln-650" href="#ln-650"></a><span class="k">end module </span><span class="n">modglobal</span><span class="w"></span>
</pre></div>

    </section>
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-xs-6 col-md-6"><p>uDALES was developed by The uDALES Team<br>&copy; 2023 
</p>
          </div>
          <div class="col-xs-6 col-md-6">
            <p class="text-right">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2023-05-30 17:12              </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
         ================================================== -->
         <!-- Placed at the end of the document so the pages load faster -->
    <!--
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        -->
        <script src="../js/bootstrap.min.js"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="../js/ie10-viewport-bug-workaround.js"></script>

        <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

          <script src="../tipuesearch/tipuesearch_content.js"></script>
          <script src="../tipuesearch/tipuesearch_set.js"></script>
          <script src="../tipuesearch/tipuesearch.js"></script>

  </body>
</html>